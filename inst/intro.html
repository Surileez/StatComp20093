<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Siyu Li" />

<meta name="date" content="2020-12-20" />

<title>Homework</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>
<style type="text/css">.tabwid table{
border-collapse:collapse;
line-height:1;
margin-left:auto;
margin-right:auto;
border-width: 0;
display: table;
margin-top: 5px;
margin-bottom: 5px;
table-layout: fixed;
border-spacing: 0;
border-color: transparent;
}
.tabwid_left table{
margin-left:0;
}
.tabwid_right table{
margin-right:0;
}
.tabwid th{
padding:0;
}
.tabwid td {
line-height: 1em;
padding: 0;
overflow: hidden;
}
.tabwid thead {
background-color: transparent;
}
.tabwid tfoot {
background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
.tabwid img {
background-color: transparent;
padding: 0;
border: 0;
border-radius: 0;
margin: 0;
}
.tabwid a {
text-decoration: none;
}

.book .book-body .page-wrapper .page-inner section.normal .tabwid table td,.book .book-body .page-wrapper .page-inner section.normal table th {
padding: 0;
}
.book .book-body .page-wrapper .page-inner section.normal .tabwid table tr {
background-color: #fff;
border-top: 0px solid #ccc;
}
.book .book-body .page-wrapper .page-inner section.normal .tabwid table tr:nth-child(2n) {
background-color: initial;
}
.book .book-body .page-wrapper .page-inner section.normal .tabwid table {
display: table;
width: initial;
border-collapse: collapse;
border-spacing: 0;
overflow: initial;
}

.remark-slide .tabwid thead, .remark-slide .tabwid tfoot, .remark-slide .tabwid tr:nth-child(even) {
background: initial;
}
.remark-slide .tabwid table {
border-top-width: 0;
border-bottom-width: 0;
}
.remark-slide-content .tabwid p{
font-size: inital;
}
</style>
<script>if (window.jQuery){
  $(document).ready(function() {
    $(".tabwid > .table").removeClass("table");
  });
}

</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework</h1>
<h4 class="author">Siyu Li</h4>
<h4 class="date">2020-12-20</h4>



<p>NULL ## 2020-09-27</p>
<div id="question-1" class="section level2">
<h2>Question 1</h2>
<p>Here is a table containing weight and height of 15 women. Do linear regression.</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer 1</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>lm.WH&lt;-<span class="kw">lm</span>(women<span class="op">$</span>weight<span class="op">~</span>women<span class="op">$</span>height)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">summary</span>(lm.WH)<span class="op">$</span>coef</span></code></pre></div>
<pre><code>##               Estimate Std. Error   t value     Pr(&gt;|t|)
## (Intercept)  -87.51667  5.9369440 -14.74103 1.711082e-09
## women$height   3.45000  0.0911365  37.85531 1.090973e-14</code></pre>
<p>The <span class="math inline">\(R^2\)</span> is 0.9910098</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co">#par(mfrow=c(2,2))</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="kw">plot</span>(lm.WH)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-2" class="section level2">
<h2>Question 2</h2>
<p>Show the table.</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer 2</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">print</span>(xtable<span class="op">::</span><span class="kw">xtable</span>(<span class="kw">head</span>(women)),<span class="dt">type=</span><span class="st">&#39;html&#39;</span>)</span></code></pre></div>
<!-- html table generated in R 4.0.2 by xtable 1.8-4 package -->
<!-- Sun Dec 20 02:18:46 2020 -->
<table border="1">
<tr>
<th>
</th>
<th>
height
</th>
<th>
weight
</th>
</tr>
<tr>
<td align="right">
1
</td>
<td align="right">
58.00
</td>
<td align="right">
115.00
</td>
</tr>
<tr>
<td align="right">
2
</td>
<td align="right">
59.00
</td>
<td align="right">
117.00
</td>
</tr>
<tr>
<td align="right">
3
</td>
<td align="right">
60.00
</td>
<td align="right">
120.00
</td>
</tr>
<tr>
<td align="right">
4
</td>
<td align="right">
61.00
</td>
<td align="right">
123.00
</td>
</tr>
<tr>
<td align="right">
5
</td>
<td align="right">
62.00
</td>
<td align="right">
126.00
</td>
</tr>
<tr>
<td align="right">
6
</td>
<td align="right">
63.00
</td>
<td align="right">
129.00
</td>
</tr>
</table>
</div>
<div id="question-3" class="section level2">
<h2>Question 3</h2>
<p>Write the formula of normal distribution function.</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer 3</h2>
<p><span class="math display">\[F(x)=\int_{0}^{x}\frac{1}{\sigma\sqrt{2\pi}}e^{- \frac{(x-\mu)^2}{2\sigma^2}}\text{d}t\]</span></p>
</div>
<div id="section" class="section level2">
<h2>2020-09-29</h2>
</div>
<div id="section-1" class="section level2">
<h2>3.3</h2>
<p>The Pareto(a,b) distribution has cdf<br />
<span class="math display">\[F(x)=1-(\frac{b}{x})^{a},x\geq b&gt;0,a&gt;0\]</span><br />
Derive the probability inverse transformation <span class="math inline">\(F^{-1}(U)\)</span> and use the inverse transform method to simulate a random sample from the Pareto(2,2) distribution. Graph the density histogram of the sample with the Pareto(2,2) density superimposed for comparison.</p>
</div>
<div id="answer-1-1" class="section level2">
<h2>Answer 1</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>n &lt;-<span class="st"> </span><span class="dv">1000</span> </span>
<span id="cb5-2"><a href="#cb5-2"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(n) </span>
<span id="cb5-3"><a href="#cb5-3"></a>x &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">/</span>((<span class="dv">1</span><span class="op">-</span>u)<span class="op">^</span><span class="fl">0.5</span>) <span class="co"># F(x) =1-(2/x)^2,x&gt;=2</span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="kw">hist</span>(x, <span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span><span class="dv">8</span><span class="op">/</span>x<span class="op">^</span><span class="dv">3</span>),</span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">20</span>),<span class="dt">breaks=</span><span class="dv">100</span>)</span>
<span id="cb5-6"><a href="#cb5-6"></a>y&lt;-<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">20</span>,.<span class="dv">1</span>)</span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="kw">lines</span>(y,<span class="dv">8</span><span class="op">/</span>(y<span class="op">^</span><span class="dv">3</span>),<span class="dt">col=</span><span class="st">&#39;blue&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-2" class="section level2">
<h2>3.9</h2>
<p>The rescaled Epanechnikov kernel[85] is a symmetric density function <span class="math display">\[f_{c}(x)=\dfrac{3}{4}(1-x^{2})\]</span> Devroyc and Gyorli[71,p.236] give the following algorithm for simulation from the distribution. Generate iid <span class="math inline">\(U_{1},U_{2},U_{3}\)</span> <span class="math inline">\(\sim\)</span> <span class="math inline">\(U(-1,1)\)</span>. If <span class="math inline">\(|U_{3}|\geq |U_{2}|\)</span> and <span class="math inline">\(|U_{3}|\geq |U_{1}|\)</span>,deliver <span class="math inline">\(U_{2}\)</span>; otherwise deliver <span class="math inline">\(U_{3}\)</span>. Write a function to generate random variates from <span class="math inline">\(f_{c}\)</span>, and construct the histogram density estimate of a large simulated random sample.</p>
</div>
<div id="answer-2-1" class="section level2">
<h2>Answer 2</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>n &lt;-<span class="st"> </span><span class="dv">10000</span> </span>
<span id="cb6-2"><a href="#cb6-2"></a>u1 &lt;-<span class="st"> </span><span class="kw">runif</span>(n,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>) </span>
<span id="cb6-3"><a href="#cb6-3"></a>u2 &lt;-<span class="st"> </span><span class="kw">runif</span>(n,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>) </span>
<span id="cb6-4"><a href="#cb6-4"></a>u3 &lt;-<span class="st"> </span><span class="kw">runif</span>(n,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>) </span>
<span id="cb6-5"><a href="#cb6-5"></a>x&lt;-<span class="kw">ifelse</span>(<span class="kw">abs</span>(u3)<span class="op">&gt;=</span><span class="kw">abs</span>(u2)<span class="op">&amp;</span><span class="kw">abs</span>(u3)<span class="op">&gt;=</span><span class="kw">abs</span>(u1),u2,u3)</span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="kw">hist</span>(x, <span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span><span class="dv">3</span>(<span class="dv">1</span><span class="op">-</span>x<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">4</span>),<span class="dt">breaks=</span><span class="dv">50</span>)</span>
<span id="cb6-7"><a href="#cb6-7"></a>y&lt;-<span class="kw">seq</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,.<span class="dv">1</span>)</span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="kw">lines</span>(y,<span class="dv">3</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>y<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">4</span>,<span class="dt">col=</span><span class="st">&#39;blue&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-3" class="section level2">
<h2>3.10</h2>
<p>Prove that the algorithm given in Exercise 3.9 generates variates from the density <span class="math inline">\(f_{c}\)</span>.</p>
</div>
<div id="answer-3-1" class="section level2">
<h2>Answer 3</h2>
<p>根据均匀分布性质可知<br />
<span class="math inline">\(P(U_{i}=x)=\dfrac{1}{2},P(|U_{i}|=x)=1,0\leq x\leq 1\)</span><br />
记事件A={<span class="math inline">\(|U_{3}|\geq |U_{2}|\)</span>&amp;<span class="math inline">\(|U_{3}|\geq |U_{1}|\)</span>} <span class="math display">\[\begin{align*}
P(X=k)&amp;=P(U_{2}=k|A)P(A)+P(U_{3}=k|A^{c})P(A^c)\\  
&amp;=P(A|U_{2}=k)P(U_{2}=k)+P(A^{c}|U_{3}=k)P(U_{3}=k)\\  
&amp;=P(|U_{3}|\geq |k|,|U_{3}|\geq |U_{1}|)\dfrac{1}{2}+(1-P(|U_{1}|,|U_{2}|\leq |k|))\dfrac{1}{2}\\  
&amp;=\dfrac{1}{2}(\int_{|k|}^{1}P(|U_{3}|=v)P(|U_{3}|\leq v)dv+(1-|k|^{2}))\\  
&amp;=\dfrac{1}{2}(\int_{|k|}^{1}vdv+(1-k^{2}))\\  
&amp;=\dfrac{1}{2}(\dfrac{1-k^{2}}{2}+(1-k^{2}))\\  
&amp;=\dfrac{3}{4}(1-k^{2})\\  
&amp;=f_{c}(k),0\leq k\leq 1
\end{align*}\]</span> The algorithm given in Exercise 3.9 generates variates from the density <span class="math inline">\(f_{c}\)</span>.</p>
</div>
<div id="section-4" class="section level2">
<h2>3.13</h2>
<p>It can be shown that the mixture in Exercise 3.12 has a Pareto distribution with cdf<br />
<span class="math display">\[F(y)=1-(\dfrac{\beta}{\beta +y})^{r}, y\geq 0\]</span> (This is an alternative parameterization of the Pareto cdf given in Exercise3.3) Generate 1000 random observations from the mixture with <span class="math inline">\(r=4\)</span> and <span class="math inline">\(\beta=2\)</span>. Compare the empirical and theoretical(Pareto)dustributions by graphing the density histogram of the sample and superimposing the Pareto density curve.</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer 4</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>n &lt;-<span class="st"> </span><span class="dv">1000</span> </span>
<span id="cb7-2"><a href="#cb7-2"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(n) </span>
<span id="cb7-3"><a href="#cb7-3"></a>x &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">/</span>((<span class="dv">1</span><span class="op">-</span>u)<span class="op">^</span><span class="fl">0.25</span>)<span class="op">-</span><span class="dv">2</span> <span class="co"># F(x)=1-(2/(2+x))^4,x&gt;=0</span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="kw">hist</span>(x, <span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span><span class="dv">64</span><span class="op">/</span>(<span class="dv">2</span><span class="op">+</span>x)<span class="op">^</span><span class="dv">5</span>),</span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">10</span>),<span class="dt">breaks=</span><span class="dv">100</span>)</span>
<span id="cb7-6"><a href="#cb7-6"></a>y&lt;-<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,.<span class="dv">1</span>)</span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="kw">lines</span>(y,<span class="dv">64</span><span class="op">/</span>((<span class="dv">2</span><span class="op">+</span>y)<span class="op">^</span><span class="dv">5</span>),<span class="dt">col=</span><span class="st">&#39;blue&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-5" class="section level2">
<h2>2020-10-13</h2>
</div>
<div id="section-6" class="section level2">
<h2>5.1</h2>
<p>Compute a Monte Carlo estimate of <span class="math display">\[\int_{0}^{\pi/3}sintdt\]</span> and compare the estimate with the exact value of the integral.</p>
</div>
<div id="answer-1-2" class="section level2">
<h2>Answer 1</h2>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>n &lt;-<span class="st"> </span><span class="dv">10000</span>; </span>
<span id="cb8-2"><a href="#cb8-2"></a>t &lt;-<span class="st"> </span><span class="kw">runif</span>(n, <span class="dt">min=</span><span class="dv">0</span>, <span class="dt">max=</span>pi<span class="op">/</span><span class="dv">3</span>) <span class="co">#t~U(0,pi/3)</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>theta_hat&lt;-<span class="st"> </span><span class="kw">mean</span>(pi<span class="op">/</span><span class="dv">3</span><span class="op">*</span><span class="kw">sin</span>(t)) <span class="co">#Monte Carlo estimate </span></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="kw">print</span>(<span class="kw">c</span>(theta_hat,<span class="op">-</span><span class="kw">cos</span>(pi<span class="op">/</span><span class="dv">3</span>)<span class="op">+</span><span class="kw">cos</span>(<span class="dv">0</span>)))<span class="co">#compare</span></span></code></pre></div>
<pre><code>## [1] 0.4985727 0.5000000</code></pre>
<p>The Monte Carlo estimate and the exact value of the integral are close.</p>
</div>
<div id="section-7" class="section level2">
<h2>5.7</h2>
<p>Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate <span class="math inline">\(\theta\)</span> by the antithetic variate approach and by the simple Monte Carlo method. Compute an empirical estimate of the percent reduction in variance using the antithetic variate. Compare the result with the theoretical value from Exercise 5.6. <span class="math display">\[\theta=\int_{0}^{1}e^{x}dx\]</span></p>
</div>
<div id="answer-2-2" class="section level2">
<h2>Answer 2</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>antithetic&lt;-<span class="cf">function</span>(n,<span class="dt">anti=</span><span class="ot">TRUE</span>){</span>
<span id="cb10-2"><a href="#cb10-2"></a>  x1 &lt;-<span class="st"> </span><span class="kw">runif</span>(n);</span>
<span id="cb10-3"><a href="#cb10-3"></a>  u &lt;-<span class="st"> </span>x1[<span class="dv">1</span><span class="op">:</span>n<span class="op">/</span><span class="dv">2</span>]</span>
<span id="cb10-4"><a href="#cb10-4"></a>  v &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>u;</span>
<span id="cb10-5"><a href="#cb10-5"></a>  x2&lt;-<span class="st"> </span><span class="kw">c</span>(u,v)</span>
<span id="cb10-6"><a href="#cb10-6"></a>  <span class="cf">if</span>(anti)</span>
<span id="cb10-7"><a href="#cb10-7"></a>  <span class="kw">return</span> (<span class="kw">mean</span>(<span class="kw">exp</span>(x2)))</span>
<span id="cb10-8"><a href="#cb10-8"></a>  <span class="cf">else</span></span>
<span id="cb10-9"><a href="#cb10-9"></a>  <span class="kw">return</span> (<span class="kw">mean</span>(<span class="kw">exp</span>(x1)))</span>
<span id="cb10-10"><a href="#cb10-10"></a>}</span>
<span id="cb10-11"><a href="#cb10-11"></a></span>
<span id="cb10-12"><a href="#cb10-12"></a>n &lt;-<span class="st"> </span><span class="dv">10000</span>; </span>
<span id="cb10-13"><a href="#cb10-13"></a><span class="co">#antithetic variate approach</span></span>
<span id="cb10-14"><a href="#cb10-14"></a>theta_anti&lt;-<span class="kw">antithetic</span>(n) </span>
<span id="cb10-15"><a href="#cb10-15"></a><span class="co">#simple Monte Carlo method</span></span>
<span id="cb10-16"><a href="#cb10-16"></a>theta_simple&lt;-<span class="kw">antithetic</span>(n,<span class="dt">anti=</span><span class="ot">FALSE</span>) </span>
<span id="cb10-17"><a href="#cb10-17"></a>m&lt;-<span class="dv">1000</span></span>
<span id="cb10-18"><a href="#cb10-18"></a>MC_anti&lt;-MC_simple&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb10-19"><a href="#cb10-19"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb10-20"><a href="#cb10-20"></a>  MC_anti[i]&lt;-<span class="kw">antithetic</span>(n);</span>
<span id="cb10-21"><a href="#cb10-21"></a>  MC_simple[i]&lt;-<span class="kw">antithetic</span>(n,<span class="dt">anti=</span><span class="ot">FALSE</span>)</span>
<span id="cb10-22"><a href="#cb10-22"></a>}</span>
<span id="cb10-23"><a href="#cb10-23"></a><span class="co">#Compare the result with the theoretical value</span></span>
<span id="cb10-24"><a href="#cb10-24"></a><span class="kw">print</span>(<span class="kw">c</span>(theta_anti,theta_simple,<span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">-</span><span class="kw">exp</span>(<span class="dv">0</span>)))</span></code></pre></div>
<pre><code>## [1] 1.717773 1.716470 1.718282</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co">#Compute an empirical estimate of the percent reduction in variance using the antithetic variate</span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">sd</span>(MC_anti),<span class="kw">sd</span>(MC_simple),<span class="kw">sd</span>(MC_anti)<span class="op">/</span><span class="kw">sd</span>(MC_simple),<span class="dv">1</span><span class="op">-</span><span class="kw">sd</span>(MC_anti)<span class="op">/</span><span class="kw">sd</span>(MC_simple)))</span></code></pre></div>
<pre><code>## [1] 0.0008914901 0.0050786348 0.1755373576 0.8244626424</code></pre>
<p>Compare the results with the theoretical value and we find they are close.<br />
An empirical estimate of the percent reduction in variance using the antithetic variate is 0.8244626.</p>
</div>
<div id="section-8" class="section level2">
<h2>5.11</h2>
<p>If <span class="math inline">\(\hat{\theta_{1}}\)</span> and <span class="math inline">\(\hat{\theta_{2}}\)</span> are unbiased estimators of <span class="math inline">\(\theta\)</span>, and <span class="math inline">\(\theta_{1},\theta_{2}\)</span>are antithetic, we derived that <span class="math inline">\(c^{*}=1/2\)</span> is the optimal constant that minimizes the variance of <span class="math inline">\(\hat\theta_{c}=c\hat\theta_{1}+(1-c)\hat\theta_{2}\)</span>. Derive <span class="math inline">\(c^{*}\)</span> for the general case. That is, if <span class="math inline">\(\hat\theta_{1}\)</span>,<span class="math inline">\(\hat\theta_{2}\)</span> are any two unbiased estimators of <span class="math inline">\(\theta\)</span>, find the value <span class="math inline">\(c^{*}\)</span> that minimizes the variance of the <span class="math inline">\(\hat\theta_{c}=c\hat\theta_{1}+(1-c)\hat\theta_{2}\)</span> in equation(5.11).(<span class="math inline">\(c^{*}\)</span> will be a function of the variances and the covariance of the estimators.)</p>
</div>
<div id="answer-3-2" class="section level2">
<h2>Answer 3</h2>
<p><span class="math display">\[\begin{align*}
  Var\hat\theta_{c}&amp;=Var(c\hat\theta_{1}+(1-c)\hat\theta_{2})\\    
  &amp;=Var(c\hat\theta_{1})+Var((1-c)\hat\theta_{2})+2Cov(c\hat\theta_{1},(1-c)\hat\theta_{1})\\  
  &amp;=c^{2}Var\hat\theta_{1}+(1-c)^2Var\hat\theta_{2}+2c(1-c)Cov(\hat\theta_{1},\hat\theta_{2})\\  
  &amp;=(Var\hat\theta_{1}+Var\hat\theta_{2}-2Cov(\hat\theta_{1},\hat\theta_{2}))c^{2}+2(Cov(\hat\theta_{1},\hat\theta_{2})-Var\hat\theta_{2})c+Var\hat\theta_{2}\\  
  \end{align*}\]</span> <span class="math inline">\(c^{*}=\dfrac{Var\hat\theta_{2}-Cov(\hat\theta_{1},\hat\theta_{2})}{Var\hat\theta_{1}+Var\hat\theta_{2}-2Cov(\hat\theta_{1},\hat\theta_{2})}=\dfrac{Cov(\hat\theta_{2}-\hat\theta_{1},\hat\theta_{2})}{Var(\hat\theta_{1}-\hat\theta_{2})}\)</span> is the optimal constant that minimizes <span class="math inline">\(Var\hat\theta_{c}\)</span>.</p>
</div>
<div id="section-9" class="section level2">
<h2>2020-10-20</h2>
</div>
<div id="section-10" class="section level2">
<h2>5.13</h2>
<p>Find two importance functions <span class="math inline">\(f_{1}\)</span> and <span class="math inline">\(f_{2}\)</span> that are supported on <span class="math inline">\((1,\infty)\)</span> and are ‘close’ to <span class="math display">\[g(x)=\dfrac{x^{2}}{\sqrt{2\pi}}e^{-x^{2}/2},x&gt;1\]</span> Which of your two importance functions should produce the smaller variance in estimating <span class="math display">\[\int_{1}^{\infty}\dfrac{x^{2}}{\sqrt{2\pi}}e^{-x^{2}/2}dx\]</span> by importance sampling?Explain.</p>
</div>
<div id="answer-1-3" class="section level2">
<h2>Answer 1</h2>
<p>Let <span class="math inline">\(f1(x)=\dfrac{dnorm(x,\mu=0,sd=1)}{1-pnorm(1)}\)</span>, is almost normal distribution but supported on <span class="math inline">\((1,\infty)\)</span><br />
Let <span class="math inline">\(f2(x)=\dfrac{dexp(x,\lambda=0.5)}{1-pexp(1)}\)</span>，is almost exponential distribution but supported on <span class="math inline">\((1,\infty)\)</span></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>m&lt;-<span class="st"> </span><span class="fl">1e4</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>g&lt;-<span class="cf">function</span>(x){x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">1</span>)}</span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="co">#choose f1 as importance sampling</span></span>
<span id="cb14-4"><a href="#cb14-4"></a>x&lt;-<span class="kw">rnorm</span>(m)</span>
<span id="cb14-5"><a href="#cb14-5"></a>fg1&lt;-<span class="kw">g</span>(x)<span class="op">/</span><span class="kw">dnorm</span>(x)</span>
<span id="cb14-6"><a href="#cb14-6"></a>theta.hat1&lt;-<span class="kw">mean</span>(fg1)</span>
<span id="cb14-7"><a href="#cb14-7"></a><span class="co">#choose f2 as important sampling</span></span>
<span id="cb14-8"><a href="#cb14-8"></a>x&lt;-<span class="kw">rexp</span>(m,<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb14-9"><a href="#cb14-9"></a>fg2&lt;-<span class="kw">g</span>(x)<span class="op">/</span><span class="kw">dexp</span>(x,<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb14-10"><a href="#cb14-10"></a>theta.hat2&lt;-<span class="kw">mean</span>(fg2)</span>
<span id="cb14-11"><a href="#cb14-11"></a><span class="kw">print</span>(<span class="kw">c</span>(theta.hat1,theta.hat2))<span class="co">#theta results</span></span></code></pre></div>
<pre><code>## [1] 0.4116096 0.4056120</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="kw">integrate</span>(g,<span class="dv">1</span>,<span class="ot">Inf</span>)<span class="co">#true integral</span></span></code></pre></div>
<pre><code>## 0.400626 with absolute error &lt; 5.7e-07</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">sd</span>(fg1),<span class="kw">sd</span>(fg2)))<span class="co">#variance</span></span></code></pre></div>
<pre><code>## [1] 1.1357217 0.5075404</code></pre>
<p>We find that the two results of <span class="math inline">\(\hat\theta\)</span> are both close to the true integral. And <span class="math inline">\(f2\)</span> produce the smaller variance. By compute the equation below, we can get the conclusion. <span class="math display">\[Var(\hat\theta)=\int_{A}\dfrac{g^{2}(x)}{f(x)}dx-\theta^{2}\]</span>    </p>
</div>
<div id="section-11" class="section level2">
<h2>5.15</h2>
<p>Obtain the stratified importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10.</p>
</div>
<div id="answer-2-3" class="section level2">
<h2>Answer 2</h2>
<p>According to Example 5.10, we choose <span class="math inline">\(f(x)=\dfrac{e^{-x}}{1-e^{-x}}\)</span> as importance sampling.<br />
While consider each <span class="math inline">\([\dfrac{j-1}{5},\dfrac{j}{5}]\)</span>, we adjust importance sampling to <span class="math inline">\(f_{j}(x)=\dfrac{e^{-x}}{e^{-\dfrac{j-1}{5}}-e^{-\dfrac{j}{5}}}, x \in [\dfrac{j-1}{5},\dfrac{j}{5}]\)</span></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>M &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>N &lt;-<span class="st"> </span><span class="dv">50</span> </span>
<span id="cb20-3"><a href="#cb20-3"></a>k &lt;-<span class="st"> </span><span class="dv">5</span> </span>
<span id="cb20-4"><a href="#cb20-4"></a>r &lt;-<span class="st"> </span>M<span class="op">/</span>k </span>
<span id="cb20-5"><a href="#cb20-5"></a>T5 &lt;-<span class="st"> </span><span class="kw">numeric</span>(k)</span>
<span id="cb20-6"><a href="#cb20-6"></a>est &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)</span>
<span id="cb20-7"><a href="#cb20-7"></a><span class="co">#use reverse transform method</span></span>
<span id="cb20-8"><a href="#cb20-8"></a>g&lt;-<span class="cf">function</span>(x,a,b) <span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>(x<span class="op">&gt;</span>a)<span class="op">*</span>(x<span class="op">&lt;</span>b)</span>
<span id="cb20-9"><a href="#cb20-9"></a>h&lt;-<span class="cf">function</span>(u,a,b) <span class="op">-</span><span class="kw">log</span>(<span class="kw">exp</span>(<span class="op">-</span>a)<span class="op">-</span>u<span class="op">*</span>(<span class="kw">exp</span>(<span class="op">-</span>a)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>b)))</span>
<span id="cb20-10"><a href="#cb20-10"></a>fg&lt;-<span class="cf">function</span>(x,a,b) <span class="kw">g</span>(x,a,b)<span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span>a)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>b)))</span>
<span id="cb20-11"><a href="#cb20-11"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</span>
<span id="cb20-12"><a href="#cb20-12"></a>u&lt;-<span class="kw">runif</span>(M)</span>
<span id="cb20-13"><a href="#cb20-13"></a>u.s&lt;-<span class="kw">runif</span>(M<span class="op">/</span>k)</span>
<span id="cb20-14"><a href="#cb20-14"></a><span class="co">#importance sampling</span></span>
<span id="cb20-15"><a href="#cb20-15"></a>est[i, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">fg</span>(<span class="kw">h</span>(u,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb20-16"><a href="#cb20-16"></a><span class="co">#stratified importance sampling</span></span>
<span id="cb20-17"><a href="#cb20-17"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k) T5[j]&lt;-<span class="kw">mean</span>(<span class="kw">fg</span>(<span class="kw">h</span>(u.s,(j<span class="dv">-1</span>)<span class="op">/</span>k,j<span class="op">/</span>k),(j<span class="dv">-1</span>)<span class="op">/</span>k,j<span class="op">/</span>k))</span>
<span id="cb20-18"><a href="#cb20-18"></a>est[i, <span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">sum</span>(T5)</span>
<span id="cb20-19"><a href="#cb20-19"></a>}</span>
<span id="cb20-20"><a href="#cb20-20"></a><span class="kw">apply</span>(est,<span class="dv">2</span>,mean)</span></code></pre></div>
<pre><code>## [1] 0.5246536 0.5248016</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="kw">apply</span>(est,<span class="dv">2</span>,sd)</span></code></pre></div>
<pre><code>## [1] 0.0008224960 0.0004353506</code></pre>
<p>The results of <span class="math inline">\(\hat\theta\)</span> are close. Compare the variance, we find the variance using stratified importance sampling is smaller.</p>
<p>   </p>
</div>
<div id="section-12" class="section level2">
<h2>6.4</h2>
<p>Suppose that <span class="math inline">\(X_{1},...,X_{n}\)</span> are a random sample from a lognormal distribution with unknown parameters. Construct a 95% confidence interval for the parameter <span class="math inline">\(\mu\)</span>. Use a Monte Carlo method to obtain an empirical estimate of the confidence level.</p>
</div>
<div id="answer-3-3" class="section level2">
<h2>Answer 3</h2>
<p>(1)Construct a 95% confidence interval for the parameter <span class="math inline">\(\mu\)</span>. <span class="math display">\[ln(X)\sim N(\mu,\sigma^{2})\]</span> <span class="math display">\[\dfrac{ln(X)-\mu}{S/\sqrt{n}}\sim t(n-1)\]</span> <span class="math display">\[\dfrac{(n-1)S^{2}}{\sigma^{2}}\sim \chi^{2}(n-1)\]</span> 95% confidence interval for the parameter <span class="math inline">\(\mu\)</span> is <span class="math display">\[[\overline {ln(X)}-\dfrac{S}{\sqrt{n}}t_{0.025}(n-1),\overline{ln(X)}+\dfrac{S}{\sqrt{n}}t_{0.025}(n-1))],where\  S^2=Var(ln(X))\]</span> (2)Use a Monte Carlo method to obtain an empirical estimate of the confidence level.<br />
For each replicate, indexed j=1,..,m<br />
First,Generate the <span class="math inline">\(j^{th}\)</span> random number <span class="math inline">\(X_{1}^{j},..X_{n}^{j}\)</span><br />
Next,Compute the 95% confidence interval <span class="math inline">\(C_{j}\)</span> for the <span class="math inline">\(j^{th}\)</span> sample<br />
Then,Compute empirical estimate of the confidence level <span class="math inline">\(y=\dfrac{1}{m}\sum_{j=1}^{m} I(\mu \in C_{j})\)</span></p>
<p>   </p>
</div>
<div id="section-13" class="section level2">
<h2>6.5</h2>
<p>Suppose a 95% symmetric <span class="math inline">\(t\)</span>-interval is applied to estimate a mean, but the sample data are unnormal. Then the probability that the confidence interval covers the mean is not necessary equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the <span class="math inline">\(t\)</span>-interval for random sample of <span class="math inline">\(\chi^{2}(2)\)</span> data with sample size <span class="math inline">\(n=20\)</span>. Compare your <span class="math inline">\(t\)</span>-interval results with the simulation results in Example 6.4.(The <span class="math inline">\(t\)</span>-interval should be more robust to departures from nomality than the interval for variance.)</p>
</div>
<div id="answer-4-1" class="section level2">
<h2>Answer 4</h2>
<p>According to CLT, we assume 95% confidence interval for the parameter <span class="math inline">\(\mu\)</span> is <span class="math display">\[[\overline X-\dfrac{S}{\sqrt{n}}t_{0.025}(n-1),\overline{X}+\dfrac{S}{\sqrt{n}}t_{0.025}(n-1))]\]</span></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>n&lt;-<span class="dv">20</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>alpha&lt;-<span class="fl">0.05</span></span>
<span id="cb24-3"><a href="#cb24-3"></a><span class="co">#symmetric t-interval</span></span>
<span id="cb24-4"><a href="#cb24-4"></a>t_UCL&lt;-<span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="dt">expr =</span> { </span>
<span id="cb24-5"><a href="#cb24-5"></a>  x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n,<span class="dv">2</span>)</span>
<span id="cb24-6"><a href="#cb24-6"></a>  <span class="kw">c</span>(<span class="kw">mean</span>(x),(<span class="kw">var</span>(x)<span class="op">/</span>n)<span class="op">^</span>(<span class="fl">0.5</span>)<span class="op">*</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">df =</span> n<span class="dv">-1</span>)) })</span>
<span id="cb24-7"><a href="#cb24-7"></a><span class="co">#Example 6.4, use chisq sample by assuming it as normal distribution</span></span>
<span id="cb24-8"><a href="#cb24-8"></a>UCL &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="dt">expr =</span> { </span>
<span id="cb24-9"><a href="#cb24-9"></a>  x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n,<span class="dv">2</span>)</span>
<span id="cb24-10"><a href="#cb24-10"></a>  (n<span class="dv">-1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">qchisq</span>(alpha, <span class="dt">df =</span> n<span class="dv">-1</span>) })</span>
<span id="cb24-11"><a href="#cb24-11"></a><span class="co">#Example 6.4, use normal distribution sample</span></span>
<span id="cb24-12"><a href="#cb24-12"></a>UCLN &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="dt">expr =</span> { </span>
<span id="cb24-13"><a href="#cb24-13"></a>  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb24-14"><a href="#cb24-14"></a>  (n<span class="dv">-1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">qchisq</span>(alpha, <span class="dt">df =</span> n<span class="dv">-1</span>) })</span>
<span id="cb24-15"><a href="#cb24-15"></a><span class="co">#coverage probability</span></span>
<span id="cb24-16"><a href="#cb24-16"></a><span class="kw">mean</span>((t_UCL[<span class="dv">1</span>,]<span class="op">+</span>t_UCL[<span class="dv">2</span>,])<span class="op">&gt;</span><span class="dv">2</span><span class="op">&amp;</span>(t_UCL[<span class="dv">1</span>,]<span class="op">-</span>t_UCL[<span class="dv">2</span>,])<span class="op">&lt;</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.92</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="kw">mean</span>(UCL <span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 0.766</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="kw">mean</span>(UCLN <span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 0.948</code></pre>
<p>Compare the results, we find that the coverage probability of symmetric <span class="math inline">\(t\)</span>-interval is closer to 0.95 than using the <span class="math inline">\(\chi^{2}\)</span> sample by assuming it as normal distribution to estimate. Because it’s not normal distribution, the results are both less closer to 0.95 compared to the condition that the sample is from normal distribution.</p>
</div>
<div id="section-14" class="section level2">
<h2>2020-10-27</h2>
</div>
<div id="section-15" class="section level2">
<h2>6.7</h2>
<p>Estimate the power of the skewness test of normality against symmetric <span class="math inline">\(Beta(\alpha,\alpha)\)</span> distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as <span class="math inline">\(t(ν)\)</span>?</p>
</div>
<div id="answer-1-4" class="section level2">
<h2>Answer 1</h2>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="co">#computes the sample skewness coeff.</span></span>
<span id="cb30-3"><a href="#cb30-3"></a>xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb30-4"><a href="#cb30-4"></a>m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb30-5"><a href="#cb30-5"></a>m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb30-6"><a href="#cb30-6"></a><span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</span>
<span id="cb30-7"><a href="#cb30-7"></a>}</span>
<span id="cb30-8"><a href="#cb30-8"></a>n &lt;-<span class="st"> </span><span class="dv">30</span></span>
<span id="cb30-9"><a href="#cb30-9"></a>m &lt;-<span class="st"> </span><span class="dv">2500</span></span>
<span id="cb30-10"><a href="#cb30-10"></a>a&lt;-<span class="fl">0.1</span></span>
<span id="cb30-11"><a href="#cb30-11"></a>alpha &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">100</span>, <span class="dv">1</span>))</span>
<span id="cb30-12"><a href="#cb30-12"></a>N &lt;-<span class="st"> </span><span class="kw">length</span>(alpha)</span>
<span id="cb30-13"><a href="#cb30-13"></a>pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb30-14"><a href="#cb30-14"></a><span class="co">#critical value for the skewness test</span></span>
<span id="cb30-15"><a href="#cb30-15"></a>cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>a<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</span>
<span id="cb30-16"><a href="#cb30-16"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { <span class="co">#for each epsilon</span></span>
<span id="cb30-17"><a href="#cb30-17"></a>e &lt;-<span class="st"> </span>alpha[j]</span>
<span id="cb30-18"><a href="#cb30-18"></a>sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb30-19"><a href="#cb30-19"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate</span></span>
<span id="cb30-20"><a href="#cb30-20"></a>x &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n, e, e)</span>
<span id="cb30-21"><a href="#cb30-21"></a>sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</span>
<span id="cb30-22"><a href="#cb30-22"></a>}</span>
<span id="cb30-23"><a href="#cb30-23"></a>pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</span>
<span id="cb30-24"><a href="#cb30-24"></a>}</span>
<span id="cb30-25"><a href="#cb30-25"></a><span class="co">#plot power vs alpha</span></span>
<span id="cb30-26"><a href="#cb30-26"></a><span class="kw">plot</span>(alpha, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb30-27"><a href="#cb30-27"></a><span class="dt">xlab =</span> <span class="kw">bquote</span>(alpha))</span>
<span id="cb30-28"><a href="#cb30-28"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.1</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb30-29"><a href="#cb30-29"></a>se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) <span class="co">#add standard errors</span></span>
<span id="cb30-30"><a href="#cb30-30"></a><span class="kw">lines</span>(alpha, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb30-31"><a href="#cb30-31"></a><span class="kw">lines</span>(alpha, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>n &lt;-<span class="st"> </span><span class="dv">30</span></span>
<span id="cb31-2"><a href="#cb31-2"></a>m &lt;-<span class="st"> </span><span class="dv">2500</span></span>
<span id="cb31-3"><a href="#cb31-3"></a>a&lt;-<span class="fl">0.1</span></span>
<span id="cb31-4"><a href="#cb31-4"></a>v&lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">100</span>, <span class="dv">1</span>))</span>
<span id="cb31-5"><a href="#cb31-5"></a>N &lt;-<span class="st"> </span><span class="kw">length</span>(v)</span>
<span id="cb31-6"><a href="#cb31-6"></a>pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb31-7"><a href="#cb31-7"></a><span class="co">#critical value for the skewness test</span></span>
<span id="cb31-8"><a href="#cb31-8"></a>cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>a<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</span>
<span id="cb31-9"><a href="#cb31-9"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { <span class="co">#for each epsilon</span></span>
<span id="cb31-10"><a href="#cb31-10"></a>e &lt;-<span class="st"> </span>v[j]</span>
<span id="cb31-11"><a href="#cb31-11"></a>sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb31-12"><a href="#cb31-12"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate</span></span>
<span id="cb31-13"><a href="#cb31-13"></a>x &lt;-<span class="st"> </span><span class="kw">rt</span>(n, e)</span>
<span id="cb31-14"><a href="#cb31-14"></a>sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</span>
<span id="cb31-15"><a href="#cb31-15"></a>}</span>
<span id="cb31-16"><a href="#cb31-16"></a>pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</span>
<span id="cb31-17"><a href="#cb31-17"></a>}</span>
<span id="cb31-18"><a href="#cb31-18"></a><span class="co">#plot power vs v</span></span>
<span id="cb31-19"><a href="#cb31-19"></a><span class="kw">plot</span>(v, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb31-20"><a href="#cb31-20"></a><span class="dt">xlab =</span> <span class="kw">bquote</span>(v))</span>
<span id="cb31-21"><a href="#cb31-21"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.1</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb31-22"><a href="#cb31-22"></a>se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) <span class="co">#add standard errors</span></span>
<span id="cb31-23"><a href="#cb31-23"></a><span class="kw">lines</span>(v, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb31-24"><a href="#cb31-24"></a><span class="kw">lines</span>(v, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>As for <span class="math inline">\(Beta(\alpha,\alpha)\)</span>, pwr is less than 0.1 when alpha is small. It is almost monotonic increasing.When alpha is close to infinity, pwr is closer to 0.1. That can be illustrated because <span class="math inline">\(Beta(\alpha,\alpha)\)</span> distribution is close to normality.<br />
As for heavy-tailed symmetric alternatives such as <span class="math inline">\(t(ν)\)</span>, the trend of the line is reverse. It is almost monotonic decreasing. When <span class="math inline">\(v\)</span> is close to infinity, pwr is closer to 0.1. It matches with the conclusion that when <span class="math inline">\(v\to \infty\)</span>, <span class="math inline">\(t(v)\)</span> is normal distribution.<br />
Because both two distribution are symmetric, value of skewness can be seen as 0 under some situations.</p>
</div>
<div id="section-16" class="section level2">
<h2>6.8</h2>
<p>Refer to Example 6.16. Repeat the simulation, but also compute the F test of equal variance, at significance level <span class="math inline">\(\hat\alpha=0.055\)</span>. Compare the power of the Count Five test and F test for small, medium, and large sample sizes. (Recall that the <span class="math inline">\(F\)</span> test is not applicable for non-normal distributions.)</p>
</div>
<div id="answer-2-4" class="section level2">
<h2>Answer 2</h2>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="co">#Count Five test</span></span>
<span id="cb32-2"><a href="#cb32-2"></a>count5test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb32-3"><a href="#cb32-3"></a>X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb32-4"><a href="#cb32-4"></a>Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb32-5"><a href="#cb32-5"></a>outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb32-6"><a href="#cb32-6"></a>outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb32-7"><a href="#cb32-7"></a><span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb32-8"><a href="#cb32-8"></a><span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</span>
<span id="cb32-9"><a href="#cb32-9"></a>}</span>
<span id="cb32-10"><a href="#cb32-10"></a><span class="co"># generate samples under H1 to estimate power</span></span>
<span id="cb32-11"><a href="#cb32-11"></a>sigma1 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb32-12"><a href="#cb32-12"></a>sigma2 &lt;-<span class="st"> </span><span class="fl">1.5</span></span>
<span id="cb32-13"><a href="#cb32-13"></a>m &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">500</span>,<span class="dv">100000</span>)</span>
<span id="cb32-14"><a href="#cb32-14"></a>power&lt;-<span class="kw">length</span>(m)</span>
<span id="cb32-15"><a href="#cb32-15"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>){</span>
<span id="cb32-16"><a href="#cb32-16"></a>power[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">replicate</span>(m[i], <span class="dt">expr=</span>{</span>
<span id="cb32-17"><a href="#cb32-17"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, sigma1)</span>
<span id="cb32-18"><a href="#cb32-18"></a>y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, sigma2)</span>
<span id="cb32-19"><a href="#cb32-19"></a><span class="kw">count5test</span>(x, y)</span>
<span id="cb32-20"><a href="#cb32-20"></a>}))</span>
<span id="cb32-21"><a href="#cb32-21"></a>}</span>
<span id="cb32-22"><a href="#cb32-22"></a><span class="kw">print</span>(power)</span></code></pre></div>
<pre><code>## [1] 0.30000 0.34000 0.31598</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="co">#F test</span></span>
<span id="cb34-2"><a href="#cb34-2"></a>sigma1 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb34-3"><a href="#cb34-3"></a>sigma2 &lt;-<span class="st"> </span><span class="fl">1.5</span></span>
<span id="cb34-4"><a href="#cb34-4"></a>alpha&lt;-<span class="fl">0.055</span></span>
<span id="cb34-5"><a href="#cb34-5"></a>m &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">500</span>,<span class="dv">100000</span>)</span>
<span id="cb34-6"><a href="#cb34-6"></a>power&lt;-<span class="kw">length</span>(m)</span>
<span id="cb34-7"><a href="#cb34-7"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>){</span>
<span id="cb34-8"><a href="#cb34-8"></a>power[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">replicate</span>(m[i], <span class="dt">expr=</span>{</span>
<span id="cb34-9"><a href="#cb34-9"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, sigma1)</span>
<span id="cb34-10"><a href="#cb34-10"></a>y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, sigma2)</span>
<span id="cb34-11"><a href="#cb34-11"></a><span class="kw">as.integer</span>(<span class="kw">var.test</span>(x,y)<span class="op">$</span>p.value <span class="op">&lt;=</span><span class="st"> </span>alpha)</span>
<span id="cb34-12"><a href="#cb34-12"></a>}))</span>
<span id="cb34-13"><a href="#cb34-13"></a>}</span>
<span id="cb34-14"><a href="#cb34-14"></a><span class="kw">print</span>(power)</span></code></pre></div>
<pre><code>## [1] 0.60000 0.41600 0.41773</code></pre>
<p>Compare the power of the Count Five test and F test for small, medium, and large sample sizes, we find that the larger sample size makes the power be closer to the confidence level alpha. F-test is more powerful.</p>
</div>
<div id="c" class="section level2">
<h2>6.C</h2>
<p>Repeat Examples 6.8 and 6.10 for Mardia’s multivariate skewness test. Mardia [187] proposed tests of multivariate normality based on multivariate generalizations of skewness and kurtosis. If <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are <span class="math inline">\(iid\)</span>, the multivariate population skewness <span class="math inline">\(β_{1,d}\)</span>is deﬁned by Mardia as <span class="math display">\[β_{1,d}= E[(X −µ)^{T}Σ^{−1}(Y −µ)]^3\]</span> Under normality, <span class="math inline">\(β_{1,d}= 0\)</span>. The multivariate skewness statistic is <span class="math display">\[b_{1,d} =\dfrac{1}{n^2}\Sigma_{i,j=1}^{n} 
((X_{i} − \bar X)^T\hatΣ^{−1}(X_{j} − \bar X))^3, (6.5)\]</span> where <span class="math inline">\(\hat\Sigma\)</span> is the maximum likelihood estimator of covariance. Large values of <span class="math inline">\(b_{1,d}\)</span> are significant. The asymptotic distribution of <span class="math inline">\(nb_{1,d}/6\)</span> is chisquared with <span class="math inline">\(d(d +1)(d +2)/6\)</span> degrees of freedom.</p>
</div>
<div id="answer-3-4" class="section level2">
<h2>Answer 3</h2>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="co">#6.8</span></span>
<span id="cb36-2"><a href="#cb36-2"></a><span class="co">#Consider multiple normal distribution</span></span>
<span id="cb36-3"><a href="#cb36-3"></a><span class="kw">library</span>(MASS)</span>
<span id="cb36-4"><a href="#cb36-4"></a>multi_sk &lt;-<span class="st"> </span><span class="cf">function</span>(X){</span>
<span id="cb36-5"><a href="#cb36-5"></a>n &lt;-<span class="st"> </span><span class="kw">nrow</span>(X)</span>
<span id="cb36-6"><a href="#cb36-6"></a>xbar &lt;-<span class="st"> </span><span class="kw">colMeans</span>(X)</span>
<span id="cb36-7"><a href="#cb36-7"></a>sigma.hat &lt;-<span class="st"> </span><span class="kw">cov</span>(X) <span class="op">*</span><span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">/</span><span class="st"> </span>n</span>
<span id="cb36-8"><a href="#cb36-8"></a>b &lt;-<span class="st"> </span><span class="kw">sum</span>(((<span class="kw">t</span>(<span class="kw">t</span>(X) <span class="op">-</span><span class="st"> </span>xbar))<span class="op">%*%</span><span class="kw">solve</span>(sigma.hat)<span class="op">%*%</span>(<span class="kw">t</span>(X) <span class="op">-</span><span class="st"> </span>xbar))<span class="op">^</span><span class="dv">3</span>) <span class="op">/</span><span class="st"> </span>n<span class="op">^</span><span class="dv">2</span></span>
<span id="cb36-9"><a href="#cb36-9"></a><span class="kw">return</span> (b)</span>
<span id="cb36-10"><a href="#cb36-10"></a>}</span>
<span id="cb36-11"><a href="#cb36-11"></a>d=<span class="dv">2</span> <span class="co"># the dimension</span></span>
<span id="cb36-12"><a href="#cb36-12"></a>n=<span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">500</span>) <span class="co"># sample sizes</span></span>
<span id="cb36-13"><a href="#cb36-13"></a>cv=<span class="kw">qchisq</span>(<span class="fl">0.95</span>,d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>)</span>
<span id="cb36-14"><a href="#cb36-14"></a>p.reject=<span class="kw">numeric</span>(<span class="kw">length</span>(n)) </span>
<span id="cb36-15"><a href="#cb36-15"></a>m=<span class="dv">1000</span> </span>
<span id="cb36-16"><a href="#cb36-16"></a>sig&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">10</span>),<span class="dt">nrow=</span><span class="dv">2</span>)</span>
<span id="cb36-17"><a href="#cb36-17"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)) {</span>
<span id="cb36-18"><a href="#cb36-18"></a>  sktests=<span class="kw">numeric</span>(m) </span>
<span id="cb36-19"><a href="#cb36-19"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb36-20"><a href="#cb36-20"></a>    x=<span class="kw">mvrnorm</span>(n[i],<span class="kw">rep</span>(<span class="dv">0</span>,d),sig) </span>
<span id="cb36-21"><a href="#cb36-21"></a>    sktests[j]=<span class="kw">as.integer</span>(<span class="kw">abs</span>(n[i]<span class="op">*</span><span class="kw">multi_sk</span>(x)<span class="op">/</span><span class="dv">6</span>) <span class="op">&gt;=</span><span class="st"> </span>cv )</span>
<span id="cb36-22"><a href="#cb36-22"></a>  }</span>
<span id="cb36-23"><a href="#cb36-23"></a>  p.reject[i]=<span class="kw">mean</span>(sktests) <span class="co">#proportion rejected</span></span>
<span id="cb36-24"><a href="#cb36-24"></a>}</span>
<span id="cb36-25"><a href="#cb36-25"></a>p.reject</span></code></pre></div>
<pre><code>## [1] 0.006 0.028 0.037 0.034 0.039 0.050</code></pre>
<p>As sample size increases, the answer increases, and it is closer to alpha.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="co">#6.10</span></span>
<span id="cb38-2"><a href="#cb38-2"></a>d&lt;-<span class="dv">2</span></span>
<span id="cb38-3"><a href="#cb38-3"></a><span class="kw">library</span>(MASS)</span>
<span id="cb38-4"><a href="#cb38-4"></a>alpha &lt;-<span class="st"> </span><span class="fl">.1</span></span>
<span id="cb38-5"><a href="#cb38-5"></a>n &lt;-<span class="st"> </span><span class="dv">30</span></span>
<span id="cb38-6"><a href="#cb38-6"></a>m &lt;-<span class="st"> </span><span class="dv">500</span></span>
<span id="cb38-7"><a href="#cb38-7"></a>epsilon &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">.15</span>, <span class="fl">.02</span>), <span class="kw">seq</span>(.<span class="dv">15</span>, <span class="dv">1</span>, <span class="fl">.05</span>))</span>
<span id="cb38-8"><a href="#cb38-8"></a>N &lt;-<span class="st"> </span><span class="kw">length</span>(epsilon)</span>
<span id="cb38-9"><a href="#cb38-9"></a>pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb38-10"><a href="#cb38-10"></a>cv&lt;-<span class="kw">qchisq</span>(<span class="dv">1</span><span class="op">-</span>alpha,d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>)</span>
<span id="cb38-11"><a href="#cb38-11"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { <span class="co">#for each epsilon</span></span>
<span id="cb38-12"><a href="#cb38-12"></a>e &lt;-<span class="st"> </span>epsilon[j]</span>
<span id="cb38-13"><a href="#cb38-13"></a>sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb38-14"><a href="#cb38-14"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate</span></span>
<span id="cb38-15"><a href="#cb38-15"></a> sigma &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>,</span>
<span id="cb38-16"><a href="#cb38-16"></a> <span class="dt">size =</span> n, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e, e))</span>
<span id="cb38-17"><a href="#cb38-17"></a> x=<span class="kw">matrix</span>(<span class="dv">0</span>,n,d)</span>
<span id="cb38-18"><a href="#cb38-18"></a>  <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb38-19"><a href="#cb38-19"></a>  x[k,] &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(<span class="dv">1</span>, <span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>), <span class="kw">diag</span>(sigma[k]<span class="op">^</span><span class="dv">2</span>,d))}</span>
<span id="cb38-20"><a href="#cb38-20"></a> sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(n<span class="op">*</span><span class="kw">abs</span>(<span class="kw">multi_sk</span>(x))<span class="op">/</span><span class="dv">6</span> <span class="op">&gt;=</span><span class="st"> </span>cv)</span>
<span id="cb38-21"><a href="#cb38-21"></a>}</span>
<span id="cb38-22"><a href="#cb38-22"></a>pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</span>
<span id="cb38-23"><a href="#cb38-23"></a>}</span>
<span id="cb38-24"><a href="#cb38-24"></a><span class="co">#plot power vs epsilon</span></span>
<span id="cb38-25"><a href="#cb38-25"></a><span class="kw">plot</span>(epsilon, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb38-26"><a href="#cb38-26"></a><span class="dt">xlab =</span> <span class="kw">bquote</span>(epsilon), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb38-27"><a href="#cb38-27"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.1</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb38-28"><a href="#cb38-28"></a>se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) <span class="co">#add standard errors</span></span>
<span id="cb38-29"><a href="#cb38-29"></a><span class="kw">lines</span>(epsilon, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb38-30"><a href="#cb38-30"></a><span class="kw">lines</span>(epsilon, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="discussion-i" class="section level2">
<h2>Discussion I</h2>
<p>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. Can we say the powers are different at 0.05 level? What is the corresponding hypothesis test problem? What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test? What information is needed to test your hypothesis?</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p>We can’t say the powers are different at 0.05 level simply.<br />
1.We need do comparison. <span class="math display">\[H_{0}:po1=p2\leftrightarrow H_{1}:p1 \not= p2.\]</span> 2.The two-sample can’t be used because the samples are not independent.<br />
3.If we use McNemar test, we need to know information as below:<br />
(1)rejecting method 1 but accepting method 2; (2)rejecting method 2 but accepting method 1.</p>
</div>
<div id="section-17" class="section level2">
<h2>2020-11-03</h2>
</div>
<div id="section-18" class="section level2">
<h2>7.1</h2>
<p>Compute a jackknife estimate of the bias and the standard error of the correlation statistic in Example 7.2.</p>
</div>
<div id="answer-1-5" class="section level2">
<h2>Answer 1</h2>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="kw">library</span>(bootstrap)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;bootstrap&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>n &lt;-<span class="st"> </span><span class="kw">nrow</span>(law) <span class="co">#sample size</span></span>
<span id="cb41-2"><a href="#cb41-2"></a>theta_hat &lt;-<span class="st"> </span><span class="kw">cor</span>(law<span class="op">$</span>LSAT, law<span class="op">$</span>GPA)</span>
<span id="cb41-3"><a href="#cb41-3"></a>theta_j &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb41-4"><a href="#cb41-4"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb41-5"><a href="#cb41-5"></a><span class="co">#randomly select the indices</span></span>
<span id="cb41-6"><a href="#cb41-6"></a>  x&lt;-law[<span class="op">-</span>i,]</span>
<span id="cb41-7"><a href="#cb41-7"></a>  LSAT &lt;-<span class="st"> </span>x<span class="op">$</span>LSAT</span>
<span id="cb41-8"><a href="#cb41-8"></a>  GPA &lt;-<span class="st"> </span>x<span class="op">$</span>GPA</span>
<span id="cb41-9"><a href="#cb41-9"></a>  theta_j[i] &lt;-<span class="st"> </span><span class="kw">cor</span>(LSAT, GPA)</span>
<span id="cb41-10"><a href="#cb41-10"></a>}</span>
<span id="cb41-11"><a href="#cb41-11"></a>bias_jack &lt;-<span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(<span class="kw">mean</span>(theta_j) <span class="op">-</span><span class="st"> </span>theta_hat) </span>
<span id="cb41-12"><a href="#cb41-12"></a><span class="co">#jackknife bias</span></span>
<span id="cb41-13"><a href="#cb41-13"></a>se_jack &lt;-<span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">var</span>(theta_j) <span class="op">/</span><span class="st"> </span>n)</span>
<span id="cb41-14"><a href="#cb41-14"></a><span class="co">#jackknife standard error </span></span>
<span id="cb41-15"><a href="#cb41-15"></a><span class="kw">cat</span>(<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>,<span class="st">&#39;Jackknife bias&#39;</span>,bias_jack,<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>, <span class="st">&#39;Jackknife standard error &#39;</span>,se_jack)</span></code></pre></div>
<pre><code>## 
##  Jackknife bias -0.006473623 
##  Jackknife standard error  0.1425186</code></pre>
</div>
<div id="section-19" class="section level2">
<h2>7.5</h2>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for the mean time between failures 1/λ by the standard normal, basic, percentile, and BCa methods. Compare the intervals and explain why they may differ.</p>
</div>
<div id="answer-2-5" class="section level2">
<h2>Answer 2</h2>
<p>We assume <span class="math inline">\(X\sim exp(\lambda)\)</span>, thus, <span class="math inline">\(\theta=E(X)=\dfrac{1}{\lambda}\)</span>.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="kw">library</span>(boot)</span>
<span id="cb43-2"><a href="#cb43-2"></a><span class="kw">mean</span>(aircondit[,<span class="dv">1</span>])<span class="co">#theta</span></span></code></pre></div>
<pre><code>## [1] 108.0833</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a>N=<span class="dv">200</span><span class="co">#boot sample size</span></span>
<span id="cb45-2"><a href="#cb45-2"></a>bootstrap_result&lt;-<span class="kw">boot</span>(aircondit,<span class="dt">statistic=</span> <span class="cf">function</span>(x,ind){<span class="kw">mean</span>(x[ind,<span class="dv">1</span>])},<span class="dt">R=</span>N)</span>
<span id="cb45-3"><a href="#cb45-3"></a><span class="kw">boot.ci</span>(bootstrap_result, <span class="dt">conf =</span> <span class="fl">0.95</span>, <span class="dt">type =</span> <span class="st">&#39;all&#39;</span>)</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 200 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = bootstrap_result, conf = 0.95, type = &quot;all&quot;)
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 39.0, 180.6 )   ( 24.4, 169.9 )  
## 
## Level     Percentile            BCa          
## 95%   ( 46.3, 191.7 )   ( 59.2, 225.8 )  
## Calculations and Intervals on Original Scale
## Some basic intervals may be unstable
## Some percentile intervals may be unstable
## Warning : BCa Intervals used Extreme Quantiles
## Some BCa intervals may be unstable</code></pre>
<p>Standard normal: <span class="math display">\[Z=\dfrac{\hat\theta-E\hat\theta}{se\hat\theta}\]</span> ninfty,according to Theorm CLL，ZN(0,1).Assume it is unbiased,95% bootstrap confidence intervals is <span class="math display">\[[\theta \pm z_{0.025}\hat se(\hat\theta)]\]</span> Basic:<br />
<span class="math display">\[P((\hat\theta-\theta)_{\alpha/2}&lt;\hat\theta-\theta&lt;(\hat\theta-\theta)_{1-\alpha/2})=1-\alpha\]</span> We use <span class="math inline">\(\hat\theta^*-\theta\)</span> to estimate <span class="math inline">\(\hat\theta-\theta\)</span> <span class="math display">\[P((\hat\theta^*-\theta)_{\alpha/2}&lt;\hat\theta-\theta&lt;(\hat\theta^*-\theta)_{1-\alpha/2})=1-\alpha\]</span> 95% bootstrap confidence intervals is <span class="math display">\[[2\hat\theta-\hat\theta_{1-\alpha/2}^*,2\hat\theta-\hat\theta_{\alpha/2}^*]\]</span> BCa:<br />
Bias-corrected compared to percentile method.<br />
The four methods get different computing results related to bootstrap samples. Thus, they differ, as the bootstrap samples differ.</p>
</div>
<div id="section-20" class="section level2">
<h2>7.8</h2>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hatθ\)</span>.</p>
</div>
<div id="answer-3-5" class="section level2">
<h2>Answer 3</h2>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="kw">library</span>(bootstrap)</span>
<span id="cb47-2"><a href="#cb47-2"></a><span class="kw">library</span>(boot)</span>
<span id="cb47-3"><a href="#cb47-3"></a>lambda_hat&lt;-<span class="kw">eigen</span>(<span class="kw">cov</span>(scor))<span class="op">$</span>values</span>
<span id="cb47-4"><a href="#cb47-4"></a>theta_hat &lt;-<span class="st"> </span>lambda_hat[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(lambda_hat) </span>
<span id="cb47-5"><a href="#cb47-5"></a>N &lt;-<span class="st"> </span><span class="dv">200</span> <span class="co">#sample size</span></span>
<span id="cb47-6"><a href="#cb47-6"></a>n &lt;-<span class="st"> </span><span class="kw">nrow</span>(scor) </span>
<span id="cb47-7"><a href="#cb47-7"></a><span class="co"># Jackknife </span></span>
<span id="cb47-8"><a href="#cb47-8"></a>theta_j &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n) </span>
<span id="cb47-9"><a href="#cb47-9"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) { </span>
<span id="cb47-10"><a href="#cb47-10"></a>   x &lt;-<span class="st"> </span>scor [<span class="op">-</span>i,] </span>
<span id="cb47-11"><a href="#cb47-11"></a>   lambda &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cov</span>(x))<span class="op">$</span>values </span>
<span id="cb47-12"><a href="#cb47-12"></a>   theta_j[i] &lt;-<span class="st"> </span>lambda[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(lambda) </span>
<span id="cb47-13"><a href="#cb47-13"></a>   } </span>
<span id="cb47-14"><a href="#cb47-14"></a>bias_jack &lt;-<span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(<span class="kw">mean</span>(theta_j) <span class="op">-</span><span class="st"> </span>theta_hat) </span>
<span id="cb47-15"><a href="#cb47-15"></a><span class="co">#jackknife bias</span></span>
<span id="cb47-16"><a href="#cb47-16"></a>se_jack &lt;-<span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">var</span>(theta_j) <span class="op">/</span><span class="st"> </span>n)</span>
<span id="cb47-17"><a href="#cb47-17"></a><span class="co">#jackknife standard error</span></span>
<span id="cb47-18"><a href="#cb47-18"></a><span class="kw">cat</span>(<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>,<span class="st">&#39;Jackknife bias&#39;</span>,bias_jack,<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>,<span class="st">&#39;Jackknife standard error&#39;</span>,se_jack )</span></code></pre></div>
<pre><code>## 
##  Jackknife bias 0.001069139 
##  Jackknife standard error 0.04955231</code></pre>
</div>
<div id="section-21" class="section level2">
<h2>7.11</h2>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Use leave-two-out cross validation to compare the models.</p>
</div>
<div id="answer-4-2" class="section level2">
<h2>Answer 4</h2>
<ol style="list-style-type: decimal">
<li>Linear: <span class="math inline">\(Y = β_0 + β_1X + ε\)</span>.</li>
<li>Quadratic: <span class="math inline">\(Y = β_0 + β_1X + β_2X^2 + ε\)</span>.</li>
<li>Exponential: <span class="math inline">\(log(Y) = log(β_0) + β_1X + ε\)</span>.</li>
<li>Log-Log: <span class="math inline">\(log(Y) = β_0 + β_1log(X) + ε\)</span>.</li>
</ol>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a>n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic) <span class="co">#in DAAG ironslag</span></span>
<span id="cb49-2"><a href="#cb49-2"></a>e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb49-3"><a href="#cb49-3"></a>t=<span class="dv">1</span></span>
<span id="cb49-4"><a href="#cb49-4"></a>a &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">10</span>, <span class="dv">40</span>, <span class="fl">.1</span>) <span class="co">#sequence for plotting fits</span></span>
<span id="cb49-5"><a href="#cb49-5"></a><span class="co"># for n-fold cross validation</span></span>
<span id="cb49-6"><a href="#cb49-6"></a><span class="co"># fit models on leave-two-out samples</span></span>
<span id="cb49-7"><a href="#cb49-7"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(n<span class="dv">-1</span>)) </span>
<span id="cb49-8"><a href="#cb49-8"></a> <span class="cf">for</span>(j <span class="cf">in</span> (k<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n){</span>
<span id="cb49-9"><a href="#cb49-9"></a>   y &lt;-<span class="st"> </span>magnetic[<span class="kw">c</span>(<span class="op">-</span>k,<span class="op">-</span>j)]</span>
<span id="cb49-10"><a href="#cb49-10"></a>   x &lt;-<span class="st"> </span>chemical[<span class="kw">c</span>(<span class="op">-</span>k,<span class="op">-</span>j)]</span>
<span id="cb49-11"><a href="#cb49-11"></a>   J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb49-12"><a href="#cb49-12"></a>   yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span>chemical[<span class="kw">c</span>(k,j)]</span>
<span id="cb49-13"><a href="#cb49-13"></a>   e1[t] &lt;-<span class="st"> </span><span class="kw">mean</span>(magnetic[<span class="kw">c</span>(k,j)]<span class="op">-</span>yhat1)</span>
<span id="cb49-14"><a href="#cb49-14"></a>   J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb49-15"><a href="#cb49-15"></a>   yhat2 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[<span class="kw">c</span>(k,j)] <span class="op">+</span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[<span class="kw">c</span>(k,j)]<span class="op">^</span><span class="dv">2</span></span>
<span id="cb49-16"><a href="#cb49-16"></a>   e2[t] &lt;-<span class="st"> </span><span class="kw">mean</span>(magnetic[<span class="kw">c</span>(k,j)] <span class="op">-</span><span class="st"> </span>yhat2)</span>
<span id="cb49-17"><a href="#cb49-17"></a>   J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb49-18"><a href="#cb49-18"></a>   logyhat3 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[<span class="kw">c</span>(k,j)]</span>
<span id="cb49-19"><a href="#cb49-19"></a>   yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)</span>
<span id="cb49-20"><a href="#cb49-20"></a>   e3[t] &lt;-<span class="st"> </span><span class="kw">mean</span>(magnetic[<span class="kw">c</span>(k,j)] <span class="op">-</span><span class="st"> </span>yhat3)</span>
<span id="cb49-21"><a href="#cb49-21"></a>   J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(x))</span>
<span id="cb49-22"><a href="#cb49-22"></a>   logyhat4 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[<span class="kw">c</span>(k,j)])</span>
<span id="cb49-23"><a href="#cb49-23"></a>   yhat4 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat4)</span>
<span id="cb49-24"><a href="#cb49-24"></a>   e4[t] &lt;-<span class="st"> </span><span class="kw">mean</span>(magnetic[<span class="kw">c</span>(k,j)] <span class="op">-</span><span class="st"> </span>yhat4)</span>
<span id="cb49-25"><a href="#cb49-25"></a>   t=t<span class="op">+</span><span class="dv">1</span></span>
<span id="cb49-26"><a href="#cb49-26"></a>}</span>
<span id="cb49-27"><a href="#cb49-27"></a><span class="kw">c</span>(<span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1]  9.975373  9.101443  9.493949 10.537646</code></pre>
<p>We also consider L2 as the best fitting model, because mean(e2^2) is smallest. The result is same as it in Example 7.18. However, the bias is smaller by using leave-two-out validation. This is expected.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a>L2 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb51-2"><a href="#cb51-2"></a>L2</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = magnetic ~ chemical + I(chemical^2))
## 
## Coefficients:
##   (Intercept)       chemical  I(chemical^2)  
##      24.49262       -1.39334        0.05452</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="kw">detach</span>(ironslag)</span></code></pre></div>
</div>
<div id="section-22" class="section level2">
<h2>2020-11-10</h2>
</div>
<div id="section-23" class="section level2">
<h2>8.3</h2>
<p>The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p>
</div>
<div id="answer-1-6" class="section level2">
<h2>Answer 1</h2>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a>count5test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb54-2"><a href="#cb54-2"></a>X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb54-3"><a href="#cb54-3"></a>Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb54-4"><a href="#cb54-4"></a>outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb54-5"><a href="#cb54-5"></a>outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb54-6"><a href="#cb54-6"></a><span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb54-7"><a href="#cb54-7"></a><span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</span>
<span id="cb54-8"><a href="#cb54-8"></a>}</span>
<span id="cb54-9"><a href="#cb54-9"></a>n1 &lt;-<span class="st"> </span><span class="dv">20</span>;n2 &lt;-<span class="st"> </span><span class="dv">30</span><span class="co">#sample sizes are not equal</span></span>
<span id="cb54-10"><a href="#cb54-10"></a>mu1 &lt;-<span class="st"> </span>mu2 &lt;-<span class="st"> </span><span class="dv">0</span>;sigma1 &lt;-<span class="st"> </span>sigma2 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb54-11"><a href="#cb54-11"></a>m &lt;-<span class="st"> </span><span class="dv">1000</span>;R &lt;-<span class="st"> </span><span class="dv">999</span>;K &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">50</span></span>
<span id="cb54-12"><a href="#cb54-12"></a>reps &lt;-<span class="st"> </span><span class="kw">numeric</span>(R)</span>
<span id="cb54-13"><a href="#cb54-13"></a>tests &lt;-<span class="st"> </span><span class="kw">replicate</span>(m, <span class="dt">expr =</span> {</span>
<span id="cb54-14"><a href="#cb54-14"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1, mu1, sigma1)</span>
<span id="cb54-15"><a href="#cb54-15"></a>y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2, mu2, sigma2)</span>
<span id="cb54-16"><a href="#cb54-16"></a>z &lt;-<span class="kw">c</span>(x,y)</span>
<span id="cb54-17"><a href="#cb54-17"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R) {</span>
<span id="cb54-18"><a href="#cb54-18"></a>k &lt;-<span class="st"> </span><span class="kw">sample</span>(K, <span class="dt">size =</span> n1, <span class="dt">replace =</span> <span class="ot">FALSE</span>)</span>
<span id="cb54-19"><a href="#cb54-19"></a>x1 &lt;-<span class="st"> </span>z[k]</span>
<span id="cb54-20"><a href="#cb54-20"></a>y1 &lt;-<span class="st"> </span>z[<span class="op">-</span>k] <span class="co">#complement of x1</span></span>
<span id="cb54-21"><a href="#cb54-21"></a>k &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n2, <span class="dt">size =</span> n1, <span class="dt">replace =</span> <span class="ot">FALSE</span>)</span>
<span id="cb54-22"><a href="#cb54-22"></a>y1 &lt;-<span class="st"> </span>y1[k] <span class="co">#control the sample size</span></span>
<span id="cb54-23"><a href="#cb54-23"></a>reps[i] &lt;-<span class="st"> </span><span class="kw">count5test</span>(x1, y1)</span>
<span id="cb54-24"><a href="#cb54-24"></a>}</span>
<span id="cb54-25"><a href="#cb54-25"></a><span class="kw">mean</span>(reps)</span>
<span id="cb54-26"><a href="#cb54-26"></a>} )</span>
<span id="cb54-27"><a href="#cb54-27"></a>alphahat &lt;-<span class="st"> </span><span class="kw">mean</span>(tests)</span>
<span id="cb54-28"><a href="#cb54-28"></a>alphahat</span></code></pre></div>
<pre><code>## [1] 0.05473874</code></pre>
<p><span class="math inline">\(X_1,...X_{20} \sim N(0,1),Y_1,...Y_{30}\sim N(0,1)\)</span>.<br />
We use permutation test to select equal sample sizes. Then, we can apply count five test. In the simulation, each sample was centered by subtracting the sample mean, and the empirical Type I error rate was 0.0547387. The adjusted “Count Five” criterion controls Type I error at <span class="math inline">\(α ≤ 0.0625\)</span> when the sample sizes are unequal. As we generated data from the same normal distribution <span class="math inline">\(N(0,1)\)</span>, this result is rational.</p>
</div>
<div id="question-2-1" class="section level2">
<h2>Question 2</h2>
<p>Design experiments for evaluating the performance of the NN,energy, and ball methods in various situations.<br />
1.Unequal variances and equal expectations</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="kw">library</span>(RANN)</span>
<span id="cb56-2"><a href="#cb56-2"></a><span class="kw">library</span>(energy)</span>
<span id="cb56-3"><a href="#cb56-3"></a><span class="kw">library</span>(boot)</span>
<span id="cb56-4"><a href="#cb56-4"></a>Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb56-5"><a href="#cb56-5"></a>n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb56-6"><a href="#cb56-6"></a><span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb56-7"><a href="#cb56-7"></a>z &lt;-<span class="st"> </span>z[ix, ];</span>
<span id="cb56-8"><a href="#cb56-8"></a>NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) </span>
<span id="cb56-9"><a href="#cb56-9"></a>block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb56-10"><a href="#cb56-10"></a>block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb56-11"><a href="#cb56-11"></a>i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="fl">+.5</span>)</span>
<span id="cb56-12"><a href="#cb56-12"></a>(i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb56-13"><a href="#cb56-13"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a>m &lt;-<span class="st"> </span><span class="dv">100</span>; k&lt;-<span class="dv">3</span>; <span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb57-2"><a href="#cb57-2"></a>mu1 &lt;-<span class="st"> </span>mu2 &lt;-<span class="st"> </span><span class="dv">0</span><span class="co">#equal expectations</span></span>
<span id="cb57-3"><a href="#cb57-3"></a>sigma1 &lt;-<span class="dv">1</span>; sigma2 &lt;-<span class="st"> </span><span class="dv">2</span><span class="co">#unequal variances </span></span>
<span id="cb57-4"><a href="#cb57-4"></a>n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">20</span>; R&lt;-<span class="dv">999</span>; n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2; N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb57-5"><a href="#cb57-5"></a>eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</span>
<span id="cb57-6"><a href="#cb57-6"></a>boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,</span>
<span id="cb57-7"><a href="#cb57-7"></a><span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</span>
<span id="cb57-8"><a href="#cb57-8"></a>ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb57-9"><a href="#cb57-9"></a>p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb57-10"><a href="#cb57-10"></a><span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</span>
<span id="cb57-11"><a href="#cb57-11"></a>}</span>
<span id="cb57-12"><a href="#cb57-12"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb57-13"><a href="#cb57-13"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb57-14"><a href="#cb57-14"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1, mu1, sigma1)<span class="co">#N(0,1)</span></span>
<span id="cb57-15"><a href="#cb57-15"></a>y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2, mu2, sigma2)<span class="co">#N(0,2)</span></span>
<span id="cb57-16"><a href="#cb57-16"></a>z &lt;-<span class="st"> </span><span class="kw">c</span>(x, y) </span>
<span id="cb57-17"><a href="#cb57-17"></a>p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb57-18"><a href="#cb57-18"></a>p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb57-19"><a href="#cb57-19"></a>p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb57-20"><a href="#cb57-20"></a>}</span>
<span id="cb57-21"><a href="#cb57-21"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>;</span>
<span id="cb57-22"><a href="#cb57-22"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb57-23"><a href="#cb57-23"></a><span class="kw">names</span>(pow)&lt;-<span class="kw">c</span>(<span class="st">&#39;NN&#39;</span>,<span class="st">&#39;energy&#39;</span>,<span class="st">&#39;Ball&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="kw">stargazer</span>(pow,<span class="dt">type=</span><span class="st">&#39;html&#39;</span>)</span></code></pre></div>
<table style="text-align:center">
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
NN
</td>
<td>
energy
</td>
<td>
Ball
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
0.270
</td>
<td>
0.320
</td>
<td>
0.510
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
</table>
<p>Under this circumstance:<span class="math inline">\(X\sim N(0,1),Y\sim N(0,2)\)</span>, Ball is the most powerful, due to Ball could be more powerful for non-location family distribution(eg:the variances are different).</p>
<p>2.Unequal variances and unequal expectations</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a>mu1&lt;-<span class="dv">0</span>;mu2&lt;-<span class="dv">1</span><span class="co">#unequal expectations</span></span>
<span id="cb59-2"><a href="#cb59-2"></a>sigma1 &lt;-<span class="dv">1</span>;sigma2&lt;-<span class="dv">2</span><span class="co">#unequal variances </span></span>
<span id="cb59-3"><a href="#cb59-3"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb59-4"><a href="#cb59-4"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb59-5"><a href="#cb59-5"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1, mu1, sigma1)<span class="co">#N(0,1)</span></span>
<span id="cb59-6"><a href="#cb59-6"></a>y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2, mu2, sigma2)<span class="co">#N(1,2)</span></span>
<span id="cb59-7"><a href="#cb59-7"></a>z &lt;-<span class="st"> </span><span class="kw">c</span>(x, y) </span>
<span id="cb59-8"><a href="#cb59-8"></a>p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb59-9"><a href="#cb59-9"></a>p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb59-10"><a href="#cb59-10"></a>p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb59-11"><a href="#cb59-11"></a>}</span>
<span id="cb59-12"><a href="#cb59-12"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb59-13"><a href="#cb59-13"></a><span class="kw">names</span>(pow)&lt;-<span class="kw">c</span>(<span class="st">&#39;NN&#39;</span>,<span class="st">&#39;energy&#39;</span>,<span class="st">&#39;Ball&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="kw">stargazer</span>(pow,<span class="dt">type=</span><span class="st">&#39;html&#39;</span>)</span></code></pre></div>
<table style="text-align:center">
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
NN
</td>
<td>
energy
</td>
<td>
Ball
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
0.520
</td>
<td>
0.800
</td>
<td>
0.860
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
</table>
<p>We reset the expectations to be unequal. Then, <span class="math inline">\(X\sim N(0,1),Y\sim N(1,2)\)</span>, Ball is the most powerful, while energy is also powerful. This is rational, due to Ball could be more powerful for unequal variances, while energy could be more powerful for unequal expectations.</p>
<p>3.Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb61-2"><a href="#cb61-2"></a>rnd &lt;-<span class="st"> </span><span class="cf">function</span>(n){</span>
<span id="cb61-3"><a href="#cb61-3"></a>      s &lt;-<span class="st"> </span><span class="kw">rbinom</span>(n, <span class="dv">1</span>, <span class="fl">0.5</span>)                   </span>
<span id="cb61-4"><a href="#cb61-4"></a>      S &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">9</span><span class="op">*</span>s)                </span>
<span id="cb61-5"><a href="#cb61-5"></a>      S  }</span>
<span id="cb61-6"><a href="#cb61-6"></a><span class="co">#bimodel distribution:0.5dnorm(1,1)+0.5dnorm(9,1)</span></span>
<span id="cb61-7"><a href="#cb61-7"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb61-8"><a href="#cb61-8"></a>x &lt;-<span class="st"> </span><span class="kw">rt</span>(n1, <span class="dt">df=</span><span class="dv">1</span>)</span>
<span id="cb61-9"><a href="#cb61-9"></a>y &lt;-<span class="st"> </span><span class="kw">rnd</span>(n2)</span>
<span id="cb61-10"><a href="#cb61-10"></a>z &lt;-<span class="st"> </span><span class="kw">c</span>(x, y) </span>
<span id="cb61-11"><a href="#cb61-11"></a>p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb61-12"><a href="#cb61-12"></a>p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb61-13"><a href="#cb61-13"></a>p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb61-14"><a href="#cb61-14"></a>}</span>
<span id="cb61-15"><a href="#cb61-15"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb61-16"><a href="#cb61-16"></a><span class="kw">names</span>(pow)&lt;-<span class="kw">c</span>(<span class="st">&#39;NN&#39;</span>,<span class="st">&#39;energy&#39;</span>,<span class="st">&#39;Ball&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a><span class="kw">stargazer</span>(pow,<span class="dt">type=</span><span class="st">&#39;html&#39;</span>)</span></code></pre></div>
<table style="text-align:center">
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
NN
</td>
<td>
energy
</td>
<td>
Ball
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
0.830
</td>
<td>
0.980
</td>
<td>
0.840
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
</table>
<p>Choose bimodel distribution:<span class="math inline">\(0.5dnorm(1,1)+0.5dnorm(9,1)\)</span>.Energy is the most powerful, while the other two are also powerful. The reason why each value of the result is big is that t distribution with 1 df (heavy-tailed distribution) differs from bimodel distribution greatly.</p>
<p>4.Unbalanced samples (say, 1 case versus 10 controls)</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a>edist<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="cf">function</span>(x, ix, sizes) {</span>
<span id="cb63-2"><a href="#cb63-2"></a><span class="co"># computes the e-statistic between 2 samples</span></span>
<span id="cb63-3"><a href="#cb63-3"></a><span class="co"># x: Euclidean distances of pooled sample</span></span>
<span id="cb63-4"><a href="#cb63-4"></a><span class="co"># sizes: vector of sample sizes</span></span>
<span id="cb63-5"><a href="#cb63-5"></a><span class="co"># ix: a permutation of row indices of x</span></span>
<span id="cb63-6"><a href="#cb63-6"></a>dst &lt;-<span class="st"> </span>x</span>
<span id="cb63-7"><a href="#cb63-7"></a>n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]</span>
<span id="cb63-8"><a href="#cb63-8"></a>n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]</span>
<span id="cb63-9"><a href="#cb63-9"></a>ii &lt;-<span class="st"> </span>ix[<span class="dv">1</span><span class="op">:</span>n1]</span>
<span id="cb63-10"><a href="#cb63-10"></a>jj &lt;-<span class="st"> </span>ix[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>(n1<span class="op">+</span>n2)]</span>
<span id="cb63-11"><a href="#cb63-11"></a>w &lt;-<span class="st"> </span>n1 <span class="op">*</span><span class="st"> </span>n2 <span class="op">/</span><span class="st"> </span>(n1 <span class="op">+</span><span class="st"> </span>n2)</span>
<span id="cb63-12"><a href="#cb63-12"></a><span class="co"># permutation applied to rows &amp; cols of dist. matrix</span></span>
<span id="cb63-13"><a href="#cb63-13"></a>m11 &lt;-<span class="st"> </span><span class="kw">sum</span>(dst[ii, ii]) <span class="op">/</span><span class="st"> </span>(n1 <span class="op">*</span><span class="st"> </span>n1)</span>
<span id="cb63-14"><a href="#cb63-14"></a>m22 &lt;-<span class="st"> </span><span class="kw">sum</span>(dst[jj, jj]) <span class="op">/</span><span class="st"> </span>(n2 <span class="op">*</span><span class="st"> </span>n2)</span>
<span id="cb63-15"><a href="#cb63-15"></a>m12 &lt;-<span class="st"> </span><span class="kw">sum</span>(dst[ii, jj]) <span class="op">/</span><span class="st"> </span>(n1 <span class="op">*</span><span class="st"> </span>n2)</span>
<span id="cb63-16"><a href="#cb63-16"></a>e &lt;-<span class="st"> </span>w <span class="op">*</span><span class="st"> </span>((m12 <span class="op">+</span><span class="st"> </span>m12) <span class="op">-</span><span class="st"> </span>(m11 <span class="op">+</span><span class="st"> </span>m22))</span>
<span id="cb63-17"><a href="#cb63-17"></a><span class="kw">return</span> (e)</span>
<span id="cb63-18"><a href="#cb63-18"></a>}</span>
<span id="cb63-19"><a href="#cb63-19"></a>eqdist.energy &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</span>
<span id="cb63-20"><a href="#cb63-20"></a>boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> <span class="kw">as.matrix</span>(<span class="kw">dist</span>(z)), <span class="dt">statistic =</span> edist<span class="fl">.2</span>,</span>
<span id="cb63-21"><a href="#cb63-21"></a><span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">R =</span> <span class="dv">999</span>, <span class="dt">sizes =</span> sizes)</span>
<span id="cb63-22"><a href="#cb63-22"></a>ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb63-23"><a href="#cb63-23"></a>p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb63-24"><a href="#cb63-24"></a><span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</span>
<span id="cb63-25"><a href="#cb63-25"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a>n1&lt;-<span class="dv">100</span>;n2&lt;-<span class="dv">10</span>;n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2; N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb64-2"><a href="#cb64-2"></a><span class="co">#n1 is ten times larger than n2</span></span>
<span id="cb64-3"><a href="#cb64-3"></a>m&lt;-<span class="dv">100</span>;<span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb64-4"><a href="#cb64-4"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb64-5"><a href="#cb64-5"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1,<span class="dv">0</span>,<span class="dv">3</span>)<span class="co">#N(0,3)</span></span>
<span id="cb64-6"><a href="#cb64-6"></a>y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2)<span class="co">#N(0,1)</span></span>
<span id="cb64-7"><a href="#cb64-7"></a>z &lt;-<span class="st"> </span><span class="kw">c</span>(x, y) </span>
<span id="cb64-8"><a href="#cb64-8"></a>p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb64-9"><a href="#cb64-9"></a>p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.energy</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb64-10"><a href="#cb64-10"></a>p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">99</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb64-11"><a href="#cb64-11"></a>}</span>
<span id="cb64-12"><a href="#cb64-12"></a>pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb64-13"><a href="#cb64-13"></a><span class="kw">names</span>(pow)&lt;-<span class="kw">c</span>(<span class="st">&#39;NN&#39;</span>,<span class="st">&#39;energy&#39;</span>,<span class="st">&#39;Ball&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="kw">stargazer</span>(pow,<span class="dt">type=</span><span class="st">&#39;html&#39;</span>)</span></code></pre></div>
<table style="text-align:center">
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
NN
</td>
<td>
energy
</td>
<td>
Ball
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
0.360
</td>
<td>
0.530
</td>
<td>
0.980
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
</table>
<p>Under this circumstance: <span class="math inline">\(X\sim N(0,3),Y\sim N(0,1)\)</span>(1 case versus 10 controls), Ball is the most powerful, due to Ball could be more powerful for non-location family distribution(eg:the variances are different).</p>
</div>
<div id="section-24" class="section level2">
<h2>2020-11-17</h2>
</div>
<div id="section-25" class="section level2">
<h2>9.4</h2>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.The standard Laplace distribution has density <span class="math display">\[f(x)=\dfrac{1}{2}e^{−|x|},x∈R\]</span> ## Answer 1</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a>rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N) {</span>
<span id="cb66-2"><a href="#cb66-2"></a>x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb66-3"><a href="#cb66-3"></a>x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</span>
<span id="cb66-4"><a href="#cb66-4"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb66-5"><a href="#cb66-5"></a>k &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb66-6"><a href="#cb66-6"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb66-7"><a href="#cb66-7"></a>y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb66-8"><a href="#cb66-8"></a><span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="kw">abs</span>(x[i<span class="dv">-1</span>])<span class="op">-</span><span class="kw">abs</span>(y))))</span>
<span id="cb66-9"><a href="#cb66-9"></a>x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span> {</span>
<span id="cb66-10"><a href="#cb66-10"></a>x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb66-11"><a href="#cb66-11"></a>k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb66-12"><a href="#cb66-12"></a>}</span>
<span id="cb66-13"><a href="#cb66-13"></a>}</span>
<span id="cb66-14"><a href="#cb66-14"></a><span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</span>
<span id="cb66-15"><a href="#cb66-15"></a>}</span>
<span id="cb66-16"><a href="#cb66-16"></a>N &lt;-<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb66-17"><a href="#cb66-17"></a>sigma &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</span>
<span id="cb66-18"><a href="#cb66-18"></a>x0 &lt;-<span class="st"> </span><span class="dv">50</span></span>
<span id="cb66-19"><a href="#cb66-19"></a>rw1 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>], x0, N)</span>
<span id="cb66-20"><a href="#cb66-20"></a>rw2 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>], x0, N)</span>
<span id="cb66-21"><a href="#cb66-21"></a>rw3 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>], x0, N)</span>
<span id="cb66-22"><a href="#cb66-22"></a>rw4 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>], x0, N)</span>
<span id="cb66-23"><a href="#cb66-23"></a><span class="co">#acceptance rates of each chain</span></span>
<span id="cb66-24"><a href="#cb66-24"></a><span class="kw">print</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">c</span>(rw1<span class="op">$</span>k<span class="op">/</span>N, rw2<span class="op">$</span>k<span class="op">/</span>N, rw3<span class="op">$</span>k<span class="op">/</span>N, rw4<span class="op">$</span>k<span class="op">/</span>N))</span></code></pre></div>
<pre><code>## [1] 0.9750 0.8310 0.5265 0.0990</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a>x&lt;-<span class="dv">1</span><span class="op">:</span><span class="dv">2000</span></span>
<span id="cb68-2"><a href="#cb68-2"></a><span class="co">#par(mfrow=c(2,2))</span></span>
<span id="cb68-3"><a href="#cb68-3"></a><span class="kw">plot</span>(x, rw1<span class="op">$</span>x, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">sub=</span><span class="st">&quot;σ=0.05&quot;</span>, <span class="dt">xlab=</span><span class="st">&#39;&#39;</span>,<span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a><span class="kw">plot</span>(x, rw2<span class="op">$</span>x, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">sub=</span><span class="st">&quot;σ=0.5&quot;</span>, <span class="dt">xlab=</span><span class="st">&#39;&#39;</span>,<span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a><span class="kw">plot</span>(x, rw3<span class="op">$</span>x, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">sub=</span><span class="st">&quot;σ=2&quot;</span>, <span class="dt">xlab=</span><span class="st">&#39;&#39;</span>,<span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a><span class="kw">plot</span>(x, rw4<span class="op">$</span>x, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">sub=</span><span class="st">&quot;σ=16&quot;</span>, <span class="dt">xlab=</span><span class="st">&#39;&#39;</span>,<span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>According to the picture, we find that the chain converges more quickly when <span class="math inline">\(\sigma\)</span> is larger. But if <span class="math inline">\(\sigma\)</span> is too large, the acceptance rates will be low, which means the simulation is inefficient.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a>a &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="kw">seq</span>(.<span class="dv">1</span>, <span class="fl">.9</span>, <span class="fl">.1</span>), <span class="fl">.95</span>)</span>
<span id="cb72-2"><a href="#cb72-2"></a>Q &lt;-<span class="st"> </span><span class="kw">qlaplace</span>(a)</span>
<span id="cb72-3"><a href="#cb72-3"></a>rw &lt;-<span class="st"> </span><span class="kw">cbind</span>(rw1<span class="op">$</span>x, rw2<span class="op">$</span>x, rw3<span class="op">$</span>x, rw4<span class="op">$</span>x)</span>
<span id="cb72-4"><a href="#cb72-4"></a>mc &lt;-<span class="st"> </span>rw[<span class="dv">501</span><span class="op">:</span>N, ]</span>
<span id="cb72-5"><a href="#cb72-5"></a>Qrw &lt;-<span class="st"> </span><span class="kw">apply</span>(mc, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="kw">quantile</span>(x, a))</span>
<span id="cb72-6"><a href="#cb72-6"></a><span class="kw">colnames</span>(Qrw)&lt;-<span class="kw">c</span>(<span class="st">&#39;σ=0.05&#39;</span>,<span class="st">&#39;σ=0.5&#39;</span>,<span class="st">&#39;σ=2&#39;</span>,<span class="st">&#39;σ=16&#39;</span>)</span>
<span id="cb72-7"><a href="#cb72-7"></a><span class="kw">xtable_to_flextable</span>(<span class="kw">xtable</span>(<span class="kw">cbind</span>(Q, Qrw)))</span></code></pre></div>
<p><div class="tabwid"><style>.cl-bc7db596{font-family:'Arial';font-size:10px;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-bc7db597{font-family:'Arial';font-size:10px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-bc7db598{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1.00;background-color:transparent;}.cl-bc7db599{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;line-height: 1.00;background-color:transparent;}.cl-bc7e560e{width:49px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bc7e560f{width:41px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bc7e5610{width:51px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bc7e5611{width:49px;background-color:transparent;vertical-align: middle;border-bottom: 1.00px solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bc7e5612{width:41px;background-color:transparent;vertical-align: middle;border-bottom: 1.00px solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bc7e5613{width:51px;background-color:transparent;vertical-align: middle;border-bottom: 1.00px solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bc7e5614{width:49px;background-color:transparent;vertical-align: middle;border-bottom: 1.00px solid rgba(0, 0, 0, 1.00);border-top: 1.00px solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bc7e5615{width:51px;background-color:transparent;vertical-align: middle;border-bottom: 1.00px solid rgba(0, 0, 0, 1.00);border-top: 1.00px solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bc7e5616{width:41px;background-color:transparent;vertical-align: middle;border-bottom: 1.00px solid rgba(0, 0, 0, 1.00);border-top: 1.00px solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table style='border-collapse:collapse;'><thead><tr style="overflow-wrap:break-word;"><td class="cl-bc7e5616"><p class="cl-bc7db598"><span class="cl-bc7db596"></span></p></td><td class="cl-bc7e5614"><p class="cl-bc7db598"><span class="cl-bc7db596">Q</span></p></td><td class="cl-bc7e5615"><p class="cl-bc7db598"><span class="cl-bc7db596">σ=0.05</span></p></td><td class="cl-bc7e5614"><p class="cl-bc7db598"><span class="cl-bc7db596">σ=0.5</span></p></td><td class="cl-bc7e5614"><p class="cl-bc7db598"><span class="cl-bc7db596">σ=2</span></p></td><td class="cl-bc7e5614"><p class="cl-bc7db598"><span class="cl-bc7db596">σ=16</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-bc7e560f"><p class="cl-bc7db599"><span class="cl-bc7db596">5%</span></p></td><td class="cl-bc7e560e"><p class="cl-bc7db599"><span class="cl-bc7db597">-1.628</span></p></td><td class="cl-bc7e5610"><p class="cl-bc7db599"><span class="cl-bc7db597">48.097</span></p></td><td class="cl-bc7e560e"><p class="cl-bc7db599"><span class="cl-bc7db597">-1.471</span></p></td><td class="cl-bc7e560e"><p class="cl-bc7db599"><span class="cl-bc7db597">-2.234</span></p></td><td class="cl-bc7e560e"><p class="cl-bc7db599"><span class="cl-bc7db597">-2.269</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bc7e560f"><p class="cl-bc7db599"><span class="cl-bc7db596">10%</span></p></td><td class="cl-bc7e560e"><p class="cl-bc7db599"><span class="cl-bc7db597">-1.138</span></p></td><td class="cl-bc7e5610"><p class="cl-bc7db599"><span class="cl-bc7db597">48.339</span></p></td><td class="cl-bc7e560e"><p class="cl-bc7db599"><span class="cl-bc7db597">-1.132</span></p></td><td class="cl-bc7e560e"><p class="cl-bc7db599"><span class="cl-bc7db597">-1.504</span></p></td><td class="cl-bc7e560e"><p class="cl-bc7db599"><span class="cl-bc7db597">-1.725</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bc7e560f"><p class="cl-bc7db599"><span class="cl-bc7db596">20%</span></p></td><td class="cl-bc7e560e"><p class="cl-bc7db599"><span class="cl-bc7db597">-0.648</span></p></td><td class="cl-bc7e5610"><p class="cl-bc7db599"><span class="cl-bc7db597">48.507</span></p></td><td class="cl-bc7e560e"><p class="cl-bc7db599"><span class="cl-bc7db597">-0.772</span></p></td><td class="cl-bc7e560e"><p class="cl-bc7db599"><span class="cl-bc7db597">-0.882</span></p></td><td class="cl-bc7e560e"><p class="cl-bc7db599"><span class="cl-bc7db597">-0.900</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bc7e560f"><p class="cl-bc7db599"><span class="cl-bc7db596">30%</span></p></td><td class="cl-bc7e560e"><p class="cl-bc7db599"><span class="cl-bc7db597">-0.361</span></p></td><td class="cl-bc7e5610"><p class="cl-bc7db599"><span class="cl-bc7db597">48.620</span></p></td><td class="cl-bc7e560e"><p class="cl-bc7db599"><span class="cl-bc7db597">-0.497</span></p></td><td class="cl-bc7e560e"><p class="cl-bc7db599"><span class="cl-bc7db597">-0.475</span></p></td><td class="cl-bc7e560e"><p class="cl-bc7db599"><span class="cl-bc7db597">-0.619</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bc7e560f"><p class="cl-bc7db599"><span class="cl-bc7db596">40%</span></p></td><td class="cl-bc7e560e"><p class="cl-bc7db599"><span class="cl-bc7db597">-0.158</span></p></td><td class="cl-bc7e5610"><p class="cl-bc7db599"><span class="cl-bc7db597">48.746</span></p></td><td class="cl-bc7e560e"><p class="cl-bc7db599"><span class="cl-bc7db597">-0.266</span></p></td><td class="cl-bc7e560e"><p class="cl-bc7db599"><span class="cl-bc7db597">-0.209</span></p></td><td class="cl-bc7e560e"><p class="cl-bc7db599"><span class="cl-bc7db597">-0.063</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bc7e560f"><p class="cl-bc7db599"><span class="cl-bc7db596">50%</span></p></td><td class="cl-bc7e560e"><p class="cl-bc7db599"><span class="cl-bc7db597">0.000</span></p></td><td class="cl-bc7e5610"><p class="cl-bc7db599"><span class="cl-bc7db597">48.854</span></p></td><td class="cl-bc7e560e"><p class="cl-bc7db599"><span class="cl-bc7db597">-0.060</span></p></td><td class="cl-bc7e560e"><p class="cl-bc7db599"><span class="cl-bc7db597">0.024</span></p></td><td class="cl-bc7e560e"><p class="cl-bc7db599"><span class="cl-bc7db597">0.169</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bc7e560f"><p class="cl-bc7db599"><span class="cl-bc7db596">60%</span></p></td><td class="cl-bc7e560e"><p class="cl-bc7db599"><span class="cl-bc7db597">0.158</span></p></td><td class="cl-bc7e5610"><p class="cl-bc7db599"><span class="cl-bc7db597">48.983</span></p></td><td class="cl-bc7e560e"><p class="cl-bc7db599"><span class="cl-bc7db597">0.161</span></p></td><td class="cl-bc7e560e"><p class="cl-bc7db599"><span class="cl-bc7db597">0.162</span></p></td><td class="cl-bc7e560e"><p class="cl-bc7db599"><span class="cl-bc7db597">0.380</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bc7e560f"><p class="cl-bc7db599"><span class="cl-bc7db596">70%</span></p></td><td class="cl-bc7e560e"><p class="cl-bc7db599"><span class="cl-bc7db597">0.361</span></p></td><td class="cl-bc7e5610"><p class="cl-bc7db599"><span class="cl-bc7db597">49.142</span></p></td><td class="cl-bc7e560e"><p class="cl-bc7db599"><span class="cl-bc7db597">0.463</span></p></td><td class="cl-bc7e560e"><p class="cl-bc7db599"><span class="cl-bc7db597">0.430</span></p></td><td class="cl-bc7e560e"><p class="cl-bc7db599"><span class="cl-bc7db597">0.729</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bc7e560f"><p class="cl-bc7db599"><span class="cl-bc7db596">80%</span></p></td><td class="cl-bc7e560e"><p class="cl-bc7db599"><span class="cl-bc7db597">0.648</span></p></td><td class="cl-bc7e5610"><p class="cl-bc7db599"><span class="cl-bc7db597">49.328</span></p></td><td class="cl-bc7e560e"><p class="cl-bc7db599"><span class="cl-bc7db597">0.995</span></p></td><td class="cl-bc7e560e"><p class="cl-bc7db599"><span class="cl-bc7db597">0.767</span></p></td><td class="cl-bc7e560e"><p class="cl-bc7db599"><span class="cl-bc7db597">0.868</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bc7e560f"><p class="cl-bc7db599"><span class="cl-bc7db596">90%</span></p></td><td class="cl-bc7e560e"><p class="cl-bc7db599"><span class="cl-bc7db597">1.138</span></p></td><td class="cl-bc7e5610"><p class="cl-bc7db599"><span class="cl-bc7db597">49.511</span></p></td><td class="cl-bc7e560e"><p class="cl-bc7db599"><span class="cl-bc7db597">2.403</span></p></td><td class="cl-bc7e560e"><p class="cl-bc7db599"><span class="cl-bc7db597">1.430</span></p></td><td class="cl-bc7e560e"><p class="cl-bc7db599"><span class="cl-bc7db597">1.677</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bc7e5612"><p class="cl-bc7db599"><span class="cl-bc7db596">95%</span></p></td><td class="cl-bc7e5611"><p class="cl-bc7db599"><span class="cl-bc7db597">1.628</span></p></td><td class="cl-bc7e5613"><p class="cl-bc7db599"><span class="cl-bc7db597">49.653</span></p></td><td class="cl-bc7e5611"><p class="cl-bc7db599"><span class="cl-bc7db597">3.171</span></p></td><td class="cl-bc7e5611"><p class="cl-bc7db599"><span class="cl-bc7db597">2.251</span></p></td><td class="cl-bc7e5611"><p class="cl-bc7db599"><span class="cl-bc7db597">2.156</span></p></td></tr></tbody></table></div> If the Qrw is close to Q, then the simulation of the distribution is good.</p>
</div>
<div id="question-2-2" class="section level2">
<h2>Question 2</h2>
<p>For Exercise 9.4, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat R &lt; 1.2\)</span>.</p>
</div>
<div id="answer-2-6" class="section level2">
<h2>Answer 2</h2>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a>Gelman.Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(psi) {</span>
<span id="cb73-2"><a href="#cb73-2"></a><span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb73-3"><a href="#cb73-3"></a><span class="co"># for chain in i-th row of X</span></span>
<span id="cb73-4"><a href="#cb73-4"></a>psi &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(psi)</span>
<span id="cb73-5"><a href="#cb73-5"></a>n &lt;-<span class="st"> </span><span class="kw">ncol</span>(psi)</span>
<span id="cb73-6"><a href="#cb73-6"></a>k &lt;-<span class="st"> </span><span class="kw">nrow</span>(psi)</span>
<span id="cb73-7"><a href="#cb73-7"></a>psi.means &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(psi) <span class="co">#row means</span></span>
<span id="cb73-8"><a href="#cb73-8"></a>B &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(psi.means) <span class="co">#between variance est.</span></span>
<span id="cb73-9"><a href="#cb73-9"></a>psi.w &lt;-<span class="st"> </span><span class="kw">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span></span>
<span id="cb73-10"><a href="#cb73-10"></a>W &lt;-<span class="st"> </span><span class="kw">mean</span>(psi.w) <span class="co">#within est.</span></span>
<span id="cb73-11"><a href="#cb73-11"></a>v.hat &lt;-<span class="st"> </span>W<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>n) <span class="co">#upper variance est.</span></span>
<span id="cb73-12"><a href="#cb73-12"></a>r.hat &lt;-<span class="st"> </span>v.hat <span class="op">/</span><span class="st"> </span>W <span class="co">#G-R statistic</span></span>
<span id="cb73-13"><a href="#cb73-13"></a><span class="kw">return</span>(r.hat)</span>
<span id="cb73-14"><a href="#cb73-14"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb74-2"><a href="#cb74-2"></a>sigma1 &lt;-<span class="fl">0.5</span> <span class="co">#parameter of proposal distribution</span></span>
<span id="cb74-3"><a href="#cb74-3"></a>sigma2 &lt;-<span class="dv">2</span> <span class="co">#parameter of proposal distribution</span></span>
<span id="cb74-4"><a href="#cb74-4"></a>k &lt;-<span class="st"> </span><span class="dv">4</span> <span class="co">#number of chains to generate</span></span>
<span id="cb74-5"><a href="#cb74-5"></a>n &lt;-<span class="st"> </span><span class="dv">15000</span> <span class="co">#length of chains</span></span>
<span id="cb74-6"><a href="#cb74-6"></a>b &lt;-<span class="st"> </span><span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb74-7"><a href="#cb74-7"></a><span class="co">#choose overdispersed initial values</span></span>
<span id="cb74-8"><a href="#cb74-8"></a>x0 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">-5</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb74-9"><a href="#cb74-9"></a><span class="co">#generate the chains</span></span>
<span id="cb74-10"><a href="#cb74-10"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>k, <span class="dt">ncol=</span>n)</span>
<span id="cb74-11"><a href="#cb74-11"></a>Y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>k, <span class="dt">ncol=</span>n)</span>
<span id="cb74-12"><a href="#cb74-12"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</span>
<span id="cb74-13"><a href="#cb74-13"></a>  X[i, ] &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma1, x0[i], n)<span class="op">$</span>x</span>
<span id="cb74-14"><a href="#cb74-14"></a>  Y[i, ] &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma2, x0[i], n)<span class="op">$</span>x</span>
<span id="cb74-15"><a href="#cb74-15"></a>}</span>
<span id="cb74-16"><a href="#cb74-16"></a><span class="co">#compute diagnostic statistics</span></span>
<span id="cb74-17"><a href="#cb74-17"></a>psi1 &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb74-18"><a href="#cb74-18"></a>psi2 &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(Y, <span class="dv">1</span>, cumsum))</span>
<span id="cb74-19"><a href="#cb74-19"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi1))</span>
<span id="cb74-20"><a href="#cb74-20"></a>psi1[i,] &lt;-<span class="st"> </span>psi1[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi1))</span>
<span id="cb74-21"><a href="#cb74-21"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi2))</span>
<span id="cb74-22"><a href="#cb74-22"></a>psi2[i,] &lt;-<span class="st"> </span>psi2[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi2))</span>
<span id="cb74-23"><a href="#cb74-23"></a><span class="co">#plot psi for the four chains</span></span>
<span id="cb74-24"><a href="#cb74-24"></a><span class="co">#par(mfrow=c(2,2))</span></span>
<span id="cb74-25"><a href="#cb74-25"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb74-26"><a href="#cb74-26"></a><span class="kw">plot</span>(psi1[i, (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb74-27"><a href="#cb74-27"></a><span class="dt">xlab=</span>i, <span class="dt">ylab=</span><span class="kw">bquote</span>(psi1))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAASFBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6kNtmAABmADpmtv+QOgCQZgCQ2/+2ZgC2///bkDrb////tmb/25D//7b//9v////H8Pd9AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHRElEQVR4nO2dD1fjKBRH4+rs6o6rU6vt9/+m2/whtkngPlooxPzuOdMTW/KIVwKEvHSaowjSlD6A2pEgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCEgsqFkNpQSlDZePLIK+Xr7/AH/9uTlcUfK0oMOrx8t14UqS6RQ7vD5Zwq1AU64+aN/8NoSzd4HFKNxJSxCEkyAIJ0G78DAvQdMokwmqBEE4CYJwmxV0eA1eaNQvqJltmPewsGue+4292/CEq03Q2DeOU9gsgg6vo5bd40coXGWC3Phx+hc9jMRdzY/XGftVDfPd4QxjbBN5ubiNFjT/IVcfNDShlfVBC4eTaRRzS2ae9iNB1nASBOEkCMLVJWhp/U6Czlg6GgkaWb4HJkEOzz1CCXJ4DkULZo46BE3DSRCEq0eQ7xadBF1cuy98bI6T5nAm4UoL6nrDYJbLTxc0rPD02zMNrvUEDuOHCxrHTPc6+cwQwVzVFYfH4fIJcj2LWyQ8e9edWbY45gojD9AWLpugxuPAnVPm5LofK8h3CjWBEcsTKHHBqHAJo140Cv96clRipifGbQWjwqWLejFeB4eluDpXJMjzm7m7NOc/pmyYyQtGhYuI6s6Ms13cCNVcvB15DlG1yQtGhTNG7e52jiP397ttWxk+ytXdr0XQOM276InHO8X5skHXsR7kRBwngr4/T3J0i1VHFDQk0MfWa5ysnZVunKZzKRmvWKJaECfQx9YbN5sduiI3ps8LZCDuFMME+th6I6f7rq+e9NY5ieyDKIHesTv9jbuSSbJcvwU1YyO6F3k66d3D26nHaltbckHj653IIqjPDzq8Pn4kFjSbCuUniyCXYfb++JFaUPSx3ErGFnTi/SmxoPsTNw96HqdC4fHeaTkV35KgCFwOnnfmFBY06YZ/oCBruOAKRq66o4gVdDrN2kmON/cwMtxi9e6ya1q4CLGCTgPT56+nU+9r3O2KTnqyvHPnYX1KpKB2AG9n07788Oh6F+qfCrrrvHDGFYLeT3J8DSO63iVB3ctk9lyM6FPs6evl8aO/jLimusl6kFfQxQVqSeI76ebhjS/qrY9DLdQ/XXpemSAb5sehlgRNPviJguwPs8zDzhZj1yaou9iAaZD9cSgUVLiLjhe0f3g79us9AW5oQZPl/OJ+YgUdXseFjFBh8+NQC4IuPrjr4uEisfOgf/umQxNF6+NQLKg0V7Yg35kTXe+kfkt+xn2J7oO6k2dnWrs/64q89U4FTbZWJyjq3uEWBUVxs6DyY1jdgmrwU6+gCkb4jpyCLOEuw17cb6+h/VQn6Hx7k4JgPajxbBek3hZUCRIESBAgQUBVguoYty6pS1DaOpJQkaBKps4TJAioQ1DTv0jQPNy49JzzeYtbKC6obzwRz0jeGQkCSgsaup8q3XRIEFCJoLTBU1J6PUiCKJwEQTgJgnCznNbKkCAgi6A227y9jW/IUTwm/h6A5OQT1CWAnOWaecJtVtCghjLMtivo81cniHIUtytILShAn0X0dHTddTjcBgUdh4x8fw6nBEWEq3QhaECCgNyC4IG6bnPTggzhJAjCSdB5lNmCWe1kEmR+oK568giyP1BXPVkERTwOVT2ZLjX4gbrVkEOQoQUFgy6/naBwivp8RPZB9EBdMOjPF8QP1AWDbkDQbUG3Iij0MEswqARBUAmCoBIEQSUIgm5F0LaQIECCAAkCJAiQIECCAAkCJAiQIECCAAkCJAhIL2jfNOFvG3RftjcWnG+E+Pznz/JOcWGsJBfUfiPjPnx8+27Rfyw43wjx9dLdkgvsbQpjJrWgfrEo+MXdXy+toLHgfCPEvk8MCOxtCmMntaA+TTj4vdS7x/9OgsaC841A+H3z3N3UDextCRNBckF/t2079IWVpxJtHzQWnG+Ea+gF+fc2hrGSWlB/8ge6gPYMaAWNBecbUEP7qwf2NoaxcndB7V39LQuiBt59vuVTjLrI3ZB98vvq3nXlnbRpkH2/fpgfBK13mDdN095vmCgOJ89qJ4rdSWS71BgLzjdCDL1LYG9TGCu6WAUkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgYA2C4L/ozssKBO3pq0KyUr+gPmu4GPUL6rOGi1G9oCFruBi1C3JZw8WoXZDLGi5G5YLGrOFiVC5ozBoudgSVC+pQCwIkCJCgmpEgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQL+B+lYc5lgIQ78AAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)) <span class="co">#restore default</span></span>
<span id="cb75-2"><a href="#cb75-2"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb75-3"><a href="#cb75-3"></a>rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb75-4"><a href="#cb75-4"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n)</span>
<span id="cb75-5"><a href="#cb75-5"></a>rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi1[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb75-6"><a href="#cb75-6"></a><span class="kw">plot</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>,<span class="dt">sub=</span><span class="st">&#39;σ=0.5&#39;</span>)</span>
<span id="cb75-7"><a href="#cb75-7"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span>
<span id="cb75-8"><a href="#cb75-8"></a>rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb75-9"><a href="#cb75-9"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n)</span>
<span id="cb75-10"><a href="#cb75-10"></a>rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi2[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb75-11"><a href="#cb75-11"></a><span class="kw">plot</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>,<span class="dt">sub=</span><span class="st">&#39;σ=2&#39;</span>)</span>
<span id="cb75-12"><a href="#cb75-12"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We choose <span class="math inline">\(\sigma=0.5,2\)</span> to compare. From the pictures, We find that each <span class="math inline">\(\hat R\)</span> converges, and <span class="math inline">\(\hat R &lt; 1.2\)</span> quickly when <span class="math inline">\(\sigma\)</span> is larger.</p>
</div>
<div id="section-26" class="section level2">
<h2>11.4</h2>
<p>Find the intersection points <span class="math inline">\(A(k)\)</span> in <span class="math inline">\((0,\sqrt k)\)</span> of the curves <span class="math display">\[S_{k−1}(a)=P(t(k − 1)&gt;\sqrt{\dfrac{a^2(k−1)}{k−a^ 2}})\]</span> and <span class="math display">\[S_k(a)=P(t(k)&gt;\sqrt{\dfrac{a^2k}{k+1−a^2}})\]</span> for<span class="math inline">\(k=4:25,100,500,1000\)</span>, where<span class="math inline">\(t(k)\)</span>is a Student <span class="math inline">\(t\)</span> random variable with <span class="math inline">\(k\)</span> degrees of freedom. (These intersection points determine the critical values for a <span class="math inline">\(t\)</span>-test for scale-mixture errors proposed by Szekely [260].) ## Answer 3</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(x,k) <span class="kw">pt</span>((x<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>x<span class="op">^</span><span class="dv">2</span>))<span class="op">^</span><span class="fl">0.5</span>,<span class="dt">df=</span>k)<span class="op">-</span><span class="kw">pt</span>((x<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k<span class="dv">-1</span>)<span class="op">/</span>(k<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span>))<span class="op">^</span><span class="fl">0.5</span>,<span class="dt">df=</span>k<span class="dv">-1</span>)</span>
<span id="cb76-2"><a href="#cb76-2"></a>k&lt;-<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb76-3"><a href="#cb76-3"></a>t&lt;-<span class="kw">round</span>(k<span class="op">^</span><span class="fl">0.5</span>,<span class="dv">3</span>)</span>
<span id="cb76-4"><a href="#cb76-4"></a>res&lt;-<span class="kw">numeric</span>(<span class="kw">length</span>(k))</span>
<span id="cb76-5"><a href="#cb76-5"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">25</span>)</span>
<span id="cb76-6"><a href="#cb76-6"></a>  res[i] &lt;-<span class="st"> </span><span class="kw">uniroot</span>(f,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">k=</span>k[i])</span>
<span id="cb76-7"><a href="#cb76-7"></a><span class="kw">unlist</span>(res)</span></code></pre></div>
<pre><code>##  [1] 1.492103 1.533556 1.562744 1.584430 1.601185 1.614521 1.625390 1.634419
##  [9] 1.642038 1.648554 1.654190 1.659114 1.663452 1.667303 1.670745 1.673840
## [17] 1.676637 1.679178 1.681496 1.683620 1.685572 1.687373 1.720608 1.729755
## [25] 1.730907</code></pre>
<p>As the picture of f showed below, we find that it is gradually approach to 0 when k is large. If we choose the upper as <span class="math inline">\(\sqrt k\)</span>, the result will be bad, because uniroot can not identify small difference. By observing the curves, we find roots are between <span class="math inline">\((1,2)\)</span>, thus, we choose this as the initial interval.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a><span class="co">#par(mfrow=c(2,2))</span></span>
<span id="cb78-2"><a href="#cb78-2"></a><span class="kw">curve</span>(<span class="kw">f</span>(x,<span class="dv">4</span>),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">5</span>),<span class="dt">sub=</span><span class="st">&#39;k=4:25&#39;</span>)</span>
<span id="cb78-3"><a href="#cb78-3"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">5</span><span class="op">:</span><span class="dv">25</span>)</span>
<span id="cb78-4"><a href="#cb78-4"></a><span class="kw">curve</span>(<span class="kw">f</span>(x,i),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">5</span>),<span class="dt">add=</span><span class="ot">TRUE</span>,<span class="dt">col=</span>i)</span>
<span id="cb78-5"><a href="#cb78-5"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">0</span>,<span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a><span class="kw">curve</span>(<span class="kw">f</span>(x,<span class="dv">100</span>),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">10</span>),<span class="dt">sub=</span><span class="st">&#39;k=100&#39;</span>)</span>
<span id="cb79-2"><a href="#cb79-2"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">0</span>,<span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a><span class="kw">curve</span>(<span class="kw">f</span>(x,<span class="dv">500</span>),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">23</span>),<span class="dt">sub=</span><span class="st">&#39;k=500&#39;</span>)</span>
<span id="cb80-2"><a href="#cb80-2"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">0</span>,<span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a><span class="kw">curve</span>(<span class="kw">f</span>(x,<span class="dv">1000</span>),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">32</span>),<span class="dt">sub=</span><span class="st">&#39;k=1000&#39;</span>)</span>
<span id="cb81-2"><a href="#cb81-2"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">0</span>,<span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-27" class="section level2">
<h2>2020-11-24</h2>
</div>
<div id="question-1-1" class="section level2">
<h2>Question 1</h2>
<table>
<thead>
<tr class="header">
<th>Genotype</th>
<th>AA</th>
<th>BB</th>
<th>OO</th>
<th>AO</th>
<th>BO</th>
<th>AB</th>
<th>Sum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Frequency</td>
<td>p^2</td>
<td>q^2</td>
<td>r^2</td>
<td>2pr</td>
<td>2qr</td>
<td>2pq</td>
<td>1</td>
</tr>
<tr class="even">
<td>Count</td>
<td><span class="math inline">\(n_{AA}\)</span></td>
<td><span class="math inline">\(n_{BB}\)</span></td>
<td><span class="math inline">\(n_{OO}\)</span></td>
<td><span class="math inline">\(n_{AO}\)</span></td>
<td><span class="math inline">\(n_{BO}\)</span></td>
<td><span class="math inline">\(n_{AB}\)</span></td>
<td>n</td>
</tr>
</tbody>
</table>
<p>Observed data: <span class="math inline">\(n_{A·} = n_{AA} + n_{AO} = 444\)</span> (A-type), <span class="math inline">\(n_{B·} = n_{BB} + n_{BO} = 132\)</span> (B-type), <span class="math inline">\(n_{OO} = 361\)</span> (O-type),<span class="math inline">\(n_{AB}\)</span> = 63 (AB-type).<br />
1.Use EM algorithm to solve MLE of p and q (consider missing data <span class="math inline">\(n_{AA}\)</span> and <span class="math inline">\(n_{BB}\)</span> ).<br />
2.Record the values of p and q that maximize the conditional likelihood in each EM steps, calculate the corresponding log-maximum likelihood values (for observed data), are they increasing?</p>
</div>
<div id="answer-1-7" class="section level2">
<h2>Answer 1</h2>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a><span class="co">#Use EM algorithm to solve MLE of p and q</span></span>
<span id="cb82-2"><a href="#cb82-2"></a>N &lt;-<span class="st"> </span><span class="dv">1000</span> <span class="co">#max. number of iterations</span></span>
<span id="cb82-3"><a href="#cb82-3"></a>L &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">2</span>, <span class="fl">.2</span>) <span class="co">#initial est. for lambdas</span></span>
<span id="cb82-4"><a href="#cb82-4"></a>tol &lt;-<span class="st"> </span>.Machine<span class="op">$</span>double.eps<span class="op">^</span><span class="fl">0.5</span></span>
<span id="cb82-5"><a href="#cb82-5"></a>L.old &lt;-<span class="st"> </span>L <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb82-6"><a href="#cb82-6"></a>value&lt;-L</span>
<span id="cb82-7"><a href="#cb82-7"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</span>
<span id="cb82-8"><a href="#cb82-8"></a>p&lt;-<span class="dv">507</span><span class="op">*</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>L[<span class="dv">1</span>])<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>L[<span class="dv">2</span>])<span class="op">/</span>(<span class="dv">1298</span><span class="op">+</span><span class="dv">507</span><span class="op">*</span>L[<span class="dv">1</span>]<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>L[<span class="dv">1</span>])<span class="op">-</span><span class="dv">195</span><span class="op">*</span>L[<span class="dv">2</span>]<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>L[<span class="dv">2</span>]))</span>
<span id="cb82-9"><a href="#cb82-9"></a>q&lt;-<span class="dv">195</span><span class="op">*</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>L[<span class="dv">2</span>])<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>L[<span class="dv">1</span>])<span class="op">/</span>(<span class="dv">1298-507</span><span class="op">*</span>L[<span class="dv">1</span>]<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>L[<span class="dv">1</span>])<span class="op">+</span><span class="dv">195</span><span class="op">*</span>L[<span class="dv">2</span>]<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>L[<span class="dv">2</span>]))</span>
<span id="cb82-10"><a href="#cb82-10"></a>L &lt;-<span class="st"> </span><span class="kw">c</span>(p,q) <span class="co">#update</span></span>
<span id="cb82-11"><a href="#cb82-11"></a>value&lt;-<span class="kw">rbind</span>(value,L)<span class="co">#record every time value </span></span>
<span id="cb82-12"><a href="#cb82-12"></a><span class="cf">if</span> (<span class="kw">sum</span>(<span class="kw">abs</span>(L <span class="op">-</span><span class="st"> </span>L.old))<span class="op">&lt;</span>tol) <span class="cf">break</span></span>
<span id="cb82-13"><a href="#cb82-13"></a>L.old &lt;-<span class="st"> </span>L</span>
<span id="cb82-14"><a href="#cb82-14"></a>}</span>
<span id="cb82-15"><a href="#cb82-15"></a><span class="kw">print</span>(<span class="kw">list</span>(L, <span class="dt">iter =</span> j, <span class="dt">tol =</span> tol))</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.4017307 0.1041868
## 
## $iter
## [1] 17
## 
## $tol
## [1] 1.490116e-08</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a><span class="co">#calculate the corresponding log-maximum likelihood values (for observed data)</span></span>
<span id="cb84-2"><a href="#cb84-2"></a>p&lt;-value[,<span class="dv">1</span>]</span>
<span id="cb84-3"><a href="#cb84-3"></a>q&lt;-value[,<span class="dv">2</span>]</span>
<span id="cb84-4"><a href="#cb84-4"></a>r&lt;-<span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q</span>
<span id="cb84-5"><a href="#cb84-5"></a>cllv&lt;-<span class="dv">444</span><span class="op">*</span><span class="kw">log</span>(p<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>r)<span class="op">+</span><span class="dv">132</span><span class="op">*</span><span class="kw">log</span>(q<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>q<span class="op">*</span>r)<span class="op">^</span><span class="dv">132</span><span class="op">+</span><span class="dv">361</span><span class="op">*</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(r)<span class="op">+</span><span class="dv">63</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>q)</span>
<span id="cb84-6"><a href="#cb84-6"></a>cllv</span></code></pre></div>
<pre><code>##        value            L            L            L            L            L 
## 9.044352e+15 2.006229e+36 1.598336e+43 2.844787e+45 1.687047e+46 3.063606e+46 
##            L            L            L            L            L            L 
## 3.749934e+46 4.014307e+46 4.107759e+46 4.139780e+46 4.150646e+46 4.154320e+46 
##            L            L            L            L            L            L 
## 4.155561e+46 4.155980e+46 4.156122e+46 4.156169e+46 4.156185e+46 4.156191e+46</code></pre>
<p>They are increasing.</p>
</div>
<div id="exercise-3advanced-r-p204" class="section level2">
<h2>Exercise 3(Advanced R P204)</h2>
<p>Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in this list:</p>
</div>
<div id="answer-2-7" class="section level2">
<h2>Answer 2</h2>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a>formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb86-2"><a href="#cb86-2"></a>mpg <span class="op">~</span><span class="st"> </span>disp,</span>
<span id="cb86-3"><a href="#cb86-3"></a>mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</span>
<span id="cb86-4"><a href="#cb86-4"></a>mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</span>
<span id="cb86-5"><a href="#cb86-5"></a>mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</span>
<span id="cb86-6"><a href="#cb86-6"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a><span class="co">##Use loops to fit linear models to the the mtcars</span></span>
<span id="cb87-2"><a href="#cb87-2"></a><span class="kw">attach</span>(mtcars)</span>
<span id="cb87-3"><a href="#cb87-3"></a>x&lt;-<span class="kw">cbind</span>(disp,<span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),disp <span class="op">+</span><span class="st"> </span>wt,<span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt)</span>
<span id="cb87-4"><a href="#cb87-4"></a>out &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="dv">4</span>)</span>
<span id="cb87-5"><a href="#cb87-5"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</span>
<span id="cb87-6"><a href="#cb87-6"></a>out[[i]] &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg<span class="op">~</span>x[,i])</span>
<span id="cb87-7"><a href="#cb87-7"></a>}</span>
<span id="cb87-8"><a href="#cb87-8"></a>out</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ x[, i])
## 
## Coefficients:
## (Intercept)       x[, i]  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ x[, i])
## 
## Coefficients:
## (Intercept)       x[, i]  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ x[, i])
## 
## Coefficients:
## (Intercept)       x[, i]  
##    29.67540     -0.04097  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ x[, i])
## 
## Coefficients:
## (Intercept)       x[, i]  
##      37.357       -5.357</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a><span class="co">##Use lapply to fit linear models to the the mtcars</span></span>
<span id="cb89-2"><a href="#cb89-2"></a>x&lt;-<span class="kw">as.data.frame</span>(x)</span>
<span id="cb89-3"><a href="#cb89-3"></a><span class="kw">lapply</span>(x,<span class="cf">function</span>(x) <span class="kw">lm</span>(mpg<span class="op">~</span>x))</span></code></pre></div>
<pre><code>## $disp
## 
## Call:
## lm(formula = mpg ~ x)
## 
## Coefficients:
## (Intercept)            x  
##    29.59985     -0.04122  
## 
## 
## $V2
## 
## Call:
## lm(formula = mpg ~ x)
## 
## Coefficients:
## (Intercept)            x  
##       10.75      1557.67  
## 
## 
## $V3
## 
## Call:
## lm(formula = mpg ~ x)
## 
## Coefficients:
## (Intercept)            x  
##    29.67540     -0.04097  
## 
## 
## $V4
## 
## Call:
## lm(formula = mpg ~ x)
## 
## Coefficients:
## (Intercept)            x  
##      37.357       -5.357</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1"></a><span class="kw">detach</span>(mtcars)</span></code></pre></div>
</div>
<div id="exercise-3advanced-r-p213-214" class="section level2">
<h2>Exercise 3(Advanced R P213-214)</h2>
<p>The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial.<br />
Extra challenge: get rid of the anonymous function by using [[ directly.</p>
</div>
<div id="answer-3-6" class="section level2">
<h2>Answer 3</h2>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1"></a>trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(</span>
<span id="cb92-2"><a href="#cb92-2"></a><span class="dv">100</span>,</span>
<span id="cb92-3"><a href="#cb92-3"></a><span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb92-4"><a href="#cb92-4"></a><span class="dt">simplify =</span> <span class="ot">FALSE</span></span>
<span id="cb92-5"><a href="#cb92-5"></a>)</span>
<span id="cb92-6"><a href="#cb92-6"></a><span class="co"># Use sapply() and an anonymous function to extract the p-value from every trial</span></span>
<span id="cb92-7"><a href="#cb92-7"></a><span class="kw">sapply</span>(trials,<span class="cf">function</span>(x) x<span class="op">$</span>p.value)</span></code></pre></div>
<pre><code>##   [1] 0.81543222 0.23662441 0.84810693 0.73155513 0.02941514 0.12211359
##   [7] 0.27740387 0.28449857 0.58011142 0.38489938 0.50915803 0.15839637
##  [13] 0.96355458 0.16080265 0.77110191 0.58202775 0.89156621 0.66081903
##  [19] 0.25416188 0.12367470 0.04719487 0.41312681 0.51615859 0.39449495
##  [25] 0.14075430 0.87305898 0.59095275 0.82708070 0.26259312 0.18927595
##  [31] 0.85568287 0.68208544 0.75809751 0.59948709 0.65866557 0.59060426
##  [37] 0.87390067 0.63529100 0.55533846 0.28538731 0.45359169 0.15396254
##  [43] 0.62612458 0.17039626 0.99232548 0.42753716 0.94049198 0.19461919
##  [49] 0.04751125 0.79796482 0.29089559 0.79824780 0.35312015 0.51279069
##  [55] 0.88386765 0.53668455 0.89078769 0.50176412 0.46124720 0.16099253
##  [61] 0.37496875 0.35268630 0.94823003 0.31870078 1.00000000 0.53870854
##  [67] 0.09915792 0.43817853 0.34470947 0.76142748 0.32578373 0.84647260
##  [73] 0.75755820 0.91401515 0.72369338 0.63546639 0.91164298 0.44417572
##  [79] 0.26147170 0.62953918 0.19149386 0.39080239 0.52647860 0.25608542
##  [85] 0.40652852 0.56822678 0.52797883 0.43385259 0.69980317 0.44514745
##  [91] 0.53716052 0.37604486 0.29416698 0.26212649 0.25381436 0.95526109
##  [97] 0.66357054 0.04319279 0.97976893 0.10039757</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1"></a><span class="co">#get rid of the anonymous function by using [[ directly</span></span>
<span id="cb94-2"><a href="#cb94-2"></a><span class="kw">sapply</span>(trials,<span class="st">&#39;[[&#39;</span>,<span class="st">&#39;p.value&#39;</span>)</span></code></pre></div>
<pre><code>##   [1] 0.81543222 0.23662441 0.84810693 0.73155513 0.02941514 0.12211359
##   [7] 0.27740387 0.28449857 0.58011142 0.38489938 0.50915803 0.15839637
##  [13] 0.96355458 0.16080265 0.77110191 0.58202775 0.89156621 0.66081903
##  [19] 0.25416188 0.12367470 0.04719487 0.41312681 0.51615859 0.39449495
##  [25] 0.14075430 0.87305898 0.59095275 0.82708070 0.26259312 0.18927595
##  [31] 0.85568287 0.68208544 0.75809751 0.59948709 0.65866557 0.59060426
##  [37] 0.87390067 0.63529100 0.55533846 0.28538731 0.45359169 0.15396254
##  [43] 0.62612458 0.17039626 0.99232548 0.42753716 0.94049198 0.19461919
##  [49] 0.04751125 0.79796482 0.29089559 0.79824780 0.35312015 0.51279069
##  [55] 0.88386765 0.53668455 0.89078769 0.50176412 0.46124720 0.16099253
##  [61] 0.37496875 0.35268630 0.94823003 0.31870078 1.00000000 0.53870854
##  [67] 0.09915792 0.43817853 0.34470947 0.76142748 0.32578373 0.84647260
##  [73] 0.75755820 0.91401515 0.72369338 0.63546639 0.91164298 0.44417572
##  [79] 0.26147170 0.62953918 0.19149386 0.39080239 0.52647860 0.25608542
##  [85] 0.40652852 0.56822678 0.52797883 0.43385259 0.69980317 0.44514745
##  [91] 0.53716052 0.37604486 0.29416698 0.26212649 0.25381436 0.95526109
##  [97] 0.66357054 0.04319279 0.97976893 0.10039757</code></pre>
</div>
<div id="exercise-6advanced-r-p213-214" class="section level2">
<h2>Exercise 6(Advanced R P213-214)</h2>
<p>Implement a combination of Map() and vapply() to create an lapply() variant that iterates in parallel over all of its inputs and stores its outputs in a vector (or a matrix). What arguments should the function take?</p>
</div>
<div id="answer-4-3" class="section level2">
<h2>Answer 4</h2>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1"></a>newlist &lt;-<span class="st"> </span><span class="kw">list</span>(cars,mtcars)</span>
<span id="cb96-2"><a href="#cb96-2"></a><span class="kw">lapply</span>(newlist, <span class="cf">function</span>(x) <span class="kw">vapply</span>(x, var, <span class="kw">numeric</span>(<span class="dv">1</span>)))</span></code></pre></div>
<pre><code>## [[1]]
##     speed      dist 
##  27.95918 664.06082 
## 
## [[2]]
##          mpg          cyl         disp           hp         drat           wt 
## 3.632410e+01 3.189516e+00 1.536080e+04 4.700867e+03 2.858814e-01 9.573790e-01 
##         qsec           vs           am         gear         carb 
## 3.193166e+00 2.540323e-01 2.489919e-01 5.443548e-01 2.608871e+00</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1"></a>lapply_new &lt;-<span class="st"> </span><span class="cf">function</span>(data, f, index, <span class="dt">simplify =</span> <span class="ot">FALSE</span>){</span>
<span id="cb98-2"><a href="#cb98-2"></a>  out &lt;-<span class="st"> </span><span class="kw">Map</span>(<span class="cf">function</span>(x) <span class="kw">vapply</span>(x, f, index), data)</span>
<span id="cb98-3"><a href="#cb98-3"></a>  <span class="kw">unlist</span>(out,<span class="dt">recursive =</span> <span class="ot">FALSE</span>)</span>
<span id="cb98-4"><a href="#cb98-4"></a>}</span>
<span id="cb98-5"><a href="#cb98-5"></a><span class="kw">lapply_new</span>(newlist, var, <span class="kw">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##        speed         dist          mpg          cyl         disp           hp 
## 2.795918e+01 6.640608e+02 3.632410e+01 3.189516e+00 1.536080e+04 4.700867e+03 
##         drat           wt         qsec           vs           am         gear 
## 2.858814e-01 9.573790e-01 3.193166e+00 2.540323e-01 2.489919e-01 5.443548e-01 
##         carb 
## 2.608871e+00</code></pre>
<p>We output it as a vector, the result is the same as the former.</p>
</div>
<div id="section-28" class="section level2">
<h2>2020-12-02</h2>
</div>
<div id="section-29" class="section level2">
<h2>9.4</h2>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.The standard Laplace distribution has density <span class="math display">\[f(x)=\dfrac{1}{2}e^{−|x|},x∈R\]</span></p>
</div>
<div id="answer-1-8" class="section level2">
<h2>Answer 1</h2>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1"></a><span class="kw">library</span>(Rcpp)</span>
<span id="cb100-2"><a href="#cb100-2"></a><span class="kw">library</span>(StatComp20093)</span></code></pre></div>
<pre><code>## Registered S3 method overwritten by &#39;quantmod&#39;:
##   method            from
##   as.zoo.data.frame zoo</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1"></a>N &lt;-<span class="st"> </span><span class="dv">2001</span></span>
<span id="cb102-2"><a href="#cb102-2"></a>sigma &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</span>
<span id="cb102-3"><a href="#cb102-3"></a>x0 &lt;-<span class="st"> </span><span class="dv">50</span></span>
<span id="cb102-4"><a href="#cb102-4"></a>rw1 &lt;-<span class="st"> </span><span class="kw">rwMetropolis</span>(sigma[<span class="dv">1</span>], x0, N)</span>
<span id="cb102-5"><a href="#cb102-5"></a>rw2 &lt;-<span class="st"> </span><span class="kw">rwMetropolis</span>(sigma[<span class="dv">2</span>], x0, N)</span>
<span id="cb102-6"><a href="#cb102-6"></a>rw3 &lt;-<span class="st"> </span><span class="kw">rwMetropolis</span>(sigma[<span class="dv">3</span>], x0, N)</span>
<span id="cb102-7"><a href="#cb102-7"></a>rw4 &lt;-<span class="st"> </span><span class="kw">rwMetropolis</span>(sigma[<span class="dv">4</span>], x0, N)</span>
<span id="cb102-8"><a href="#cb102-8"></a><span class="co">#acceptance rates of each chain, the first of the chain stores the numbers of acceptance.</span></span>
<span id="cb102-9"><a href="#cb102-9"></a><span class="kw">print</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">c</span>(rw1[[<span class="dv">1</span>]], rw2[[<span class="dv">1</span>]], rw3[[<span class="dv">1</span>]], rw4[[<span class="dv">1</span>]])<span class="op">/</span>N)</span></code></pre></div>
<pre><code>## [1] 0.98650675 0.83258371 0.52623688 0.09745127</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1"></a>x&lt;-<span class="dv">1</span><span class="op">:</span><span class="dv">2000</span></span>
<span id="cb104-2"><a href="#cb104-2"></a><span class="co">#par(mfrow=c(2,2))</span></span>
<span id="cb104-3"><a href="#cb104-3"></a><span class="kw">plot</span>(x, <span class="kw">unlist</span>(rw1[<span class="op">-</span><span class="dv">1</span>]), <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">sub=</span><span class="st">&quot;σ=0.05&quot;</span>, <span class="dt">xlab=</span><span class="st">&#39;&#39;</span>,<span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1"></a><span class="kw">plot</span>(x, <span class="kw">unlist</span>(rw2[<span class="op">-</span><span class="dv">1</span>]), <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">sub=</span><span class="st">&quot;σ=0.5&quot;</span>, <span class="dt">xlab=</span><span class="st">&#39;&#39;</span>,<span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAVFBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmOpBmtttmtv+QOgCQOmaQ2/+2ZgC2///bkDrb2//b////tmb/25D//7b//9v///8mJe1AAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHEklEQVR4nO2d7WKqOBRF0zvX3pl2po7WuVh9//ccJCQGMGwCJ+FQ9/rRWg0nYTVfYojmSkYxaxdAOxQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCCAsyGyGtQTJhssHBQEoCFBYUK9pb0DTujXI6He0chNLGCVWYn1Byg2t3UlTEAiXNBdbg7UFqa9DFARQIEj3SL++IOVTIQoCUBAgk6DL3r7j+vE5IdwTCjqZN/ugcg/Gwj2foMveazn9/A3DPZ+gr/cP97CKNLKOIM0zIQ01SLWhXH1QW4Um9UFPKKhuZHYUi9SffrjnE5QaTq+hda9JB89rlZRV0Pn1I/ZSP5zR2hFlGubvNWXCMN/8nfYxZjny1KB28EqoQdfnElTXodv4RUEjHF8OiYJmZFKAfJ10/YY1RZB9Vp+hjKPY+fWPVEEKq1DOYf6yNxQknC8FgXAUBMLp66WVCdJXhSgIQEEACgJQEECdIG2GtAlSZ0jJJdcwhUhGYrAGARQK0mVInyBlA5k6QdpGegoCaBSkyhAFARQK0tXG0gVd/sud78YFfb3vmt+Xf2MLNJfmq6qNzWhilXk53D72iq5gXZrv1gW1a3wjS8fCJBOXAQ9e27qg5vSjn3jdSFsGPL9QBZgj6GjMP/v46rr0RZyzC1WAOZ10UyuqkT4ocRnwglLlZ4agv22dGBnFltagbQuaQuIy4GWZ5SXTTDpxGfCyzLKi8a2GqoFe3TXpNplIbhJkEnQy7UzpNG8U03NdMVMnXb8Zse/Z5gpSU4eyCLLD/GVfd9HzBCm6dJ9FkJsoHn/+nilITy+UsQbVHHcU9BCnpZ4OzRT0zTtpP5W+7CkoU74UVDjDuVAQQLEgHYY0C1JhSK8gJYYUC9JhSLmg9Q2pFqSho9YtSMFYr1mQfK4z0HnJVTjXJbAGSZWAgqQSioajoMLZpkNBUgWgIKmEsuFcutXm1OoFme7v4mgXdKUglNCEv8qjXtDVrmOgoHhKu0OevKFpAfULatbC5LjyMW2JzcYFLalXvlKOxtiEoPj+ZgsE3VvtaJBtC2rP0c8mg5MNeq2hgDahFzRSmkyCFt2rMUhq/CHhqRh3aiYqyLSPgihhQnNPGa1GeQQtvFcjekhz0q4+mfu5WRntpUorxl+3dE8GPY5z1zmoP52Y0kHNPaPFK+0fHxJer/XnHDxpulz7j67+MN9qzX0W4cO5zBILmnJG8Xs1Uq9J948NKkTwd8ddx+JQXUdQ/1H3ibTzXr8Gtf9s3720o39wgt6bcZ13UFWuXTVX94Qrjm9nXmNaQRP7oGX3aqCiuEYWRgqGOveJY/+TR+ewf5R71KtNaQVNO6OF92pMKU2/k3jQavtz5fEJuXsx7NE3MQ+Sizj507hvKUiQsOZREICCABQEoCDAaoI2w0qC0oJOHZ7XSDYzuWxQCpJJR0Eak81MLhuUgmTSUZDGZDOTywalIJl030/Qd4KCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUB5AVVptm5O4JdH7IL040fMMb5z0/pkAPEBVV1yap46c6/Dr104IARvt6bdW6SIYdIC7Kr0I672Otu7Z5Phw6IU7WrbQVDPkBakP0e6NgmefUru146dECUyrxZNXIhHyEuqKnvsf246//rX6bZN9+nQweMYY8SDTlAWpBt+tEOwH5h/fHtng4cMJ7ZzYFsyAGFBbWJfnzKCZINOaB0E7OJXj8Em5hoyAGlO2mb6NdBpEcNBQmFHFB4mLdlr09MZExuBMmGHFB6otgUu+5RRWZ17SgmGXKA/FuN0/g0/2jcpuYuHThghLaJSYYcwDerAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCDAFgSF+yjct1koxAYEdW6P89sslEK/oO4NlkK36k5HnaDKbjl/b0TdW3RPBVtXgzZBlfmwWwWcXxtRL4fuTd5um4ViKBNk21PnhtzONgF+m4ViKBNk25P92fJgH4WSHZFKQcFX4T3cy6EjMDMqBd1+3vug4T4KJcd6ZYLaPii00Rnm/TYLxUqkTFA7inU64c5E0W+zUAptgpp5UO/8230ULvtGjttmoRDqBGmDggAUBKAgAAUB/gdUJmm0dDENdgAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1"></a><span class="kw">plot</span>(x, <span class="kw">unlist</span>(rw3[<span class="op">-</span><span class="dv">1</span>]), <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">sub=</span><span class="st">&quot;σ=2&quot;</span>, <span class="dt">xlab=</span><span class="st">&#39;&#39;</span>,<span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1"></a><span class="kw">plot</span>(x, <span class="kw">unlist</span>(rw4[<span class="op">-</span><span class="dv">1</span>]), <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">sub=</span><span class="st">&quot;σ=16&quot;</span>, <span class="dt">xlab=</span><span class="st">&#39;&#39;</span>,<span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-2-3" class="section level2">
<h2>Question 2</h2>
<p>Compare the corresponding generated random numbers with those by the R function you wrote before using the function “qqplot”.</p>
</div>
<div id="answer-2-8" class="section level2">
<h2>Answer 2</h2>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1"></a><span class="co">#generated by the R function</span></span>
<span id="cb108-2"><a href="#cb108-2"></a>N &lt;-<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb108-3"><a href="#cb108-3"></a>rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N) {</span>
<span id="cb108-4"><a href="#cb108-4"></a>  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb108-5"><a href="#cb108-5"></a>  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</span>
<span id="cb108-6"><a href="#cb108-6"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb108-7"><a href="#cb108-7"></a>  k &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb108-8"><a href="#cb108-8"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb108-9"><a href="#cb108-9"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb108-10"><a href="#cb108-10"></a>    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="kw">abs</span>(x[i<span class="dv">-1</span>])<span class="op">-</span><span class="kw">abs</span>(y))))</span>
<span id="cb108-11"><a href="#cb108-11"></a>      x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span> {</span>
<span id="cb108-12"><a href="#cb108-12"></a>        x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb108-13"><a href="#cb108-13"></a>        k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb108-14"><a href="#cb108-14"></a>      }</span>
<span id="cb108-15"><a href="#cb108-15"></a>  }</span>
<span id="cb108-16"><a href="#cb108-16"></a>  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</span>
<span id="cb108-17"><a href="#cb108-17"></a>}</span>
<span id="cb108-18"><a href="#cb108-18"></a>rw11 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>], x0, N)</span>
<span id="cb108-19"><a href="#cb108-19"></a>rw12 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>], x0, N)</span>
<span id="cb108-20"><a href="#cb108-20"></a>rw13 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>], x0, N)</span>
<span id="cb108-21"><a href="#cb108-21"></a>rw14 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>], x0, N)</span>
<span id="cb108-22"><a href="#cb108-22"></a><span class="co">#acceptance rates of each chain</span></span>
<span id="cb108-23"><a href="#cb108-23"></a><span class="kw">print</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">c</span>(rw11<span class="op">$</span>k<span class="op">/</span>N, rw12<span class="op">$</span>k<span class="op">/</span>N, rw13<span class="op">$</span>k<span class="op">/</span>N, rw14<span class="op">$</span>k<span class="op">/</span>N))</span></code></pre></div>
<pre><code>## [1] 0.984 0.832 0.535 0.105</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1"></a><span class="co">#par(mfrow=c(2,2))</span></span>
<span id="cb110-2"><a href="#cb110-2"></a><span class="kw">qqplot</span>(<span class="kw">unlist</span>(rw1[<span class="op">-</span><span class="dv">1</span>]),rw11<span class="op">$</span>x,<span class="dt">main=</span><span class="st">&#39;σ=0.05&#39;</span>,<span class="dt">xlab=</span><span class="st">&#39;C&#39;</span>,<span class="dt">ylab=</span><span class="st">&#39;R&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1"></a><span class="kw">qqplot</span>(<span class="kw">unlist</span>(rw2[<span class="op">-</span><span class="dv">1</span>]),rw12<span class="op">$</span>x,<span class="dt">main=</span><span class="st">&#39;σ=0.5&#39;</span>,<span class="dt">xlab=</span><span class="st">&#39;C&#39;</span>,<span class="dt">ylab=</span><span class="st">&#39;R&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1"></a><span class="kw">qqplot</span>(<span class="kw">unlist</span>(rw3[<span class="op">-</span><span class="dv">1</span>]),rw13<span class="op">$</span>x,<span class="dt">main=</span><span class="st">&#39;σ=2&#39;</span>,<span class="dt">xlab=</span><span class="st">&#39;C&#39;</span>,<span class="dt">ylab=</span><span class="st">&#39;R&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1"></a><span class="kw">qqplot</span>(<span class="kw">unlist</span>(rw4[<span class="op">-</span><span class="dv">1</span>]),rw14<span class="op">$</span>x,<span class="dt">main=</span><span class="st">&#39;σ=16&#39;</span>,<span class="dt">xlab=</span><span class="st">&#39;C&#39;</span>,<span class="dt">ylab=</span><span class="st">&#39;R&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-3-1" class="section level2">
<h2>Question 3</h2>
<p>Campare the computation time of the two functions with the function “microbenchmark”.</p>
</div>
<div id="answer-3-7" class="section level2">
<h2>Answer 3</h2>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1"></a><span class="kw">library</span>(microbenchmark)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;microbenchmark&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1"></a>ts1 &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">rwC=</span><span class="kw">rwMetropolis</span>(sigma[<span class="dv">1</span>], x0, N),</span>
<span id="cb116-2"><a href="#cb116-2"></a><span class="dt">rwR=</span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>], x0, N))</span>
<span id="cb116-3"><a href="#cb116-3"></a>ts2 &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">rwC=</span><span class="kw">rwMetropolis</span>(sigma[<span class="dv">1</span>], x0, N),</span>
<span id="cb116-4"><a href="#cb116-4"></a><span class="dt">rwR=</span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>], x0, N))</span>
<span id="cb116-5"><a href="#cb116-5"></a>ts3 &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">rwC=</span><span class="kw">rwMetropolis</span>(sigma[<span class="dv">1</span>], x0, N),</span>
<span id="cb116-6"><a href="#cb116-6"></a><span class="dt">rwR=</span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>], x0, N))</span>
<span id="cb116-7"><a href="#cb116-7"></a>ts4 &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">rwC=</span><span class="kw">rwMetropolis</span>(sigma[<span class="dv">1</span>], x0, N),</span>
<span id="cb116-8"><a href="#cb116-8"></a><span class="dt">rwR=</span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>], x0, N))</span>
<span id="cb116-9"><a href="#cb116-9"></a>ts&lt;-<span class="kw">list</span>(ts1,ts2,ts3,ts4)</span>
<span id="cb116-10"><a href="#cb116-10"></a><span class="kw">lapply</span>(ts,<span class="cf">function</span>(x) <span class="kw">summary</span>(x)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)])</span></code></pre></div>
<pre><code>## [[1]]
##   expr      lq  median       uq
## 1  rwC  453.75  465.75   535.80
## 2  rwR 4890.10 5556.05 10054.05
## 
## [[2]]
##   expr      lq median      uq
## 1  rwC  450.50  459.0  487.00
## 2  rwR 4509.45 4967.1 5395.45
## 
## [[3]]
##   expr      lq  median     uq
## 1  rwC  451.55  463.35  494.5
## 2  rwR 4649.45 5117.55 5985.7
## 
## [[4]]
##   expr      lq  median       uq
## 1  rwC  467.30  750.10   932.25
## 2  rwR 4916.65 8310.25 10199.10</code></pre>
<p>Comments:<br />
Compare the qqplot, it is similar to y=x, this is rational, because the samplers generated from the same distribution.<br />
Compare the computation time of the two functions, the procession using C consumes less time.</p>
<div id="thanks-for-your-review" class="section level3">
<h3>Thanks for your review!</h3>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
